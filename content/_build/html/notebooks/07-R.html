
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Biological Computing in R &#8212; TheMulQuaBio</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Biological Computing in Python II" href="06-Python_II.html" />
    <link rel="prev" title="Biological Computing in Python I" href="05-Python_I.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">TheMulQuaBio</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to The Multilingual Quantitative Biologist!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Computing
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01-Unix.html">
   UNIX and Linux
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02-ShellScripting.html">
   Shell scripting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03-Git.html">
   Version control with Git
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04-LaTeX.html">
   Scientific documents with
   <span class="math notranslate nohighlight">
    \(\LaTeX\)
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05-Python_I.html">
   Biological Computing in Python I
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Biological Computing in R
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06-Python_II.html">
   Biological Computing in Python II
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Basic Data Analyses and Statistics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Stats-Intro.html">
   Introduction to this section
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08-Data_R.html">
   Data Management and Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12-ExpDesign.html">
   Experimental design and Data exploration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13-t_F_tests.html">
   Basic hypothesis testing:
   <span class="math notranslate nohighlight">
    \(t\)
   </span>
   and
   <span class="math notranslate nohighlight">
    \(F\)
   </span>
   tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14-regress.html">
   Linear Models: Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15-anova.html">
   Linear Models: Analysis of variance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16-MulExpl.html">
   Linear Models: Multiple explanatory variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17-MulExplInter.html">
   Linear Models: Multiple variables with interactions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18-ModelSimp.html">
   Model simplification
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Advanced Data Analyses and Statistics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="19-glm.html">
   Generalised Linear Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="20-ModelFitting-NLLS.html">
   Model Fitting using Non-linear Least-squares
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Appendix-JupyIntro.html">
   Introduction to Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Appendix-Data-Python.html">
   Data analyses  with Python &amp; Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Appendix-Maths.html">
   Mathematical models in Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Appendix-Databases.html">
   Databases
   <span class="tocSkip">
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Appendix-NLLS-Python.html">
   Model fitting in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Appendix-MiniProj.html">
   The Computing Miniproject
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Appendix-Assessment.html">
   Coursework Assessment
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/mhasoba/TheMulQuaBio/master?urlpath=tree/notebooks/07-R.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/mhasoba/TheMulQuaBio"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/mhasoba/TheMulQuaBio/issues/new?title=Issue%20on%20page%20%2Fnotebooks/07-R.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notebooks/07-R.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#why-r">
     Why R?
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#would-you-ever-need-anything-other-than-r">
       Would you ever need anything other than R?
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#installing-r">
     Installing R
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-started">
   Getting started
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#r-basics">
   R basics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#useful-r-commands">
     Useful R commands
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#baby-steps">
     Baby steps
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variable-names-and-tabbing">
     Variable names and Tabbing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operators">
     Operators
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#when-things-go-wrong">
     When things go wrong
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#types-of-parentheses">
     Types of parentheses
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variable-types">
   Variable types
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#type-conversions-and-special-values">
     Type Conversions and Special Values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#r-data-structures">
   R Data Structures
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vectors">
     Vectors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrices-and-arrays">
     Matrices and arrays
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-frames">
     Data frames
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lists">
     Lists
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-vs-dataframe">
     Matrix vs Dataframe
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-and-manipulating-data">
   Creating and manipulating data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-sequences">
     Creating sequences
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#accessing-parts-of-data-stuctures-indices-and-indexing">
     Accessing parts of data stuctures: Indices and Indexing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recycling">
     Recycling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-vector-matrix-operations">
     Basic vector-matrix operations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#strings-and-pasting">
     Strings and Pasting
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#useful-r-functions">
   Useful R functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#for-manipulating-strings">
     For manipulating strings
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mathematical">
     Mathematical
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#statistical">
     Statistical
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sets">
     Sets
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-random-numbers">
     Generating Random Numbers
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#seeding-random-number-generators">
       “Seeding” random number generators
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#your-analysis-workflow">
   Your analysis workflow
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-r-workspace-and-working-directory">
     The R Workspace and Working Directory
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#importing-and-exporting-data">
   Importing and Exporting Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relative-paths">
     Relative paths
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#writing-to-and-saving-files">
     Writing to and saving files
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-r-code">
   Writing R code
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-r-code">
   Running R code
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-source">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       source
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-rscript">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       Rscript
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#running-r-in-batch-mode">
     Running R in batch mode
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#control-flow-tools">
   Control flow tools
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#if-statements">
     <code class="docutils literal notranslate">
      <span class="pre">
       if
      </span>
     </code>
     statements
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#for-loops">
     <code class="docutils literal notranslate">
      <span class="pre">
       for
      </span>
     </code>
     loops
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#while-loops">
     <code class="docutils literal notranslate">
      <span class="pre">
       while
      </span>
     </code>
     loops
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#some-more-control-flow-tools">
     Some more control flow tools
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#breaking-out-of-loops">
       <code class="docutils literal notranslate">
        <span class="pre">
         break
        </span>
       </code>
       ing out of loops
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-next">
       Using
       <code class="docutils literal notranslate">
        <span class="pre">
         next
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-r-functions">
   Writing R Functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#your-first-r-function">
     Your first R function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functions-with-conditionals">
     Functions with conditionals
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#an-example-utility-function">
     An example utility function
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#practicals">
   Practicals
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tree-heights">
     Tree heights
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#groupwork-practical-on-tree-heights">
     Groupwork Practical on Tree Heights
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#groupwork-practical-on-tree-heights-2">
     Groupwork Practical  on Tree Heights  2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vectorization">
   Vectorization
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-allocation">
     Pre-allocation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-apply-family-of-functions">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       *apply
      </span>
     </code>
     family of functions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-vectorization-example">
       A vectorization example
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-tapply-function">
       The
       <code class="docutils literal notranslate">
        <span class="pre">
         tapply
        </span>
       </code>
       function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-by">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       by
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-replicate">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       replicate
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-plyr-and-ddply">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       plyr
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       ddply
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Practicals
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-vectorization-challenge">
     A vectorization challenge
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#errors-and-debugging">
   Errors and Debugging
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unit-testing">
     Unit testing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#debugging">
     Debugging
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#catching-errors">
     “Catching” errors
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#packages">
   Packages
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#building-your-own">
     Building your own
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   Practicals
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#is-florida-getting-warmer">
     Is Florida getting warmer?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#groupwork-practical-autocorrelation-in-florida-weather">
     Groupwork Practical: Autocorrelation in Florida weather
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#readings-and-resources">
   Readings and Resources
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#r-as-a-programming-language">
     R as a Programming language
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mathematical-modelling-and-stats-in-r">
     Mathematical modelling and Stats in R
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Debugging
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sweave-and-knitr-and-beyond">
     Sweave and knitr, and beyond
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Biological Computing in R</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#why-r">
     Why R?
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#would-you-ever-need-anything-other-than-r">
       Would you ever need anything other than R?
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#installing-r">
     Installing R
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-started">
   Getting started
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#r-basics">
   R basics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#useful-r-commands">
     Useful R commands
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#baby-steps">
     Baby steps
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variable-names-and-tabbing">
     Variable names and Tabbing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operators">
     Operators
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#when-things-go-wrong">
     When things go wrong
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#types-of-parentheses">
     Types of parentheses
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variable-types">
   Variable types
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#type-conversions-and-special-values">
     Type Conversions and Special Values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#r-data-structures">
   R Data Structures
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vectors">
     Vectors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrices-and-arrays">
     Matrices and arrays
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-frames">
     Data frames
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lists">
     Lists
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-vs-dataframe">
     Matrix vs Dataframe
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-and-manipulating-data">
   Creating and manipulating data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-sequences">
     Creating sequences
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#accessing-parts-of-data-stuctures-indices-and-indexing">
     Accessing parts of data stuctures: Indices and Indexing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recycling">
     Recycling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-vector-matrix-operations">
     Basic vector-matrix operations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#strings-and-pasting">
     Strings and Pasting
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#useful-r-functions">
   Useful R functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#for-manipulating-strings">
     For manipulating strings
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mathematical">
     Mathematical
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#statistical">
     Statistical
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sets">
     Sets
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-random-numbers">
     Generating Random Numbers
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#seeding-random-number-generators">
       “Seeding” random number generators
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#your-analysis-workflow">
   Your analysis workflow
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-r-workspace-and-working-directory">
     The R Workspace and Working Directory
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#importing-and-exporting-data">
   Importing and Exporting Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relative-paths">
     Relative paths
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#writing-to-and-saving-files">
     Writing to and saving files
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-r-code">
   Writing R code
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-r-code">
   Running R code
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-source">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       source
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-rscript">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       Rscript
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#running-r-in-batch-mode">
     Running R in batch mode
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#control-flow-tools">
   Control flow tools
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#if-statements">
     <code class="docutils literal notranslate">
      <span class="pre">
       if
      </span>
     </code>
     statements
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#for-loops">
     <code class="docutils literal notranslate">
      <span class="pre">
       for
      </span>
     </code>
     loops
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#while-loops">
     <code class="docutils literal notranslate">
      <span class="pre">
       while
      </span>
     </code>
     loops
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#some-more-control-flow-tools">
     Some more control flow tools
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#breaking-out-of-loops">
       <code class="docutils literal notranslate">
        <span class="pre">
         break
        </span>
       </code>
       ing out of loops
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-next">
       Using
       <code class="docutils literal notranslate">
        <span class="pre">
         next
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-r-functions">
   Writing R Functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#your-first-r-function">
     Your first R function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functions-with-conditionals">
     Functions with conditionals
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#an-example-utility-function">
     An example utility function
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#practicals">
   Practicals
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tree-heights">
     Tree heights
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#groupwork-practical-on-tree-heights">
     Groupwork Practical on Tree Heights
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#groupwork-practical-on-tree-heights-2">
     Groupwork Practical  on Tree Heights  2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vectorization">
   Vectorization
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-allocation">
     Pre-allocation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-apply-family-of-functions">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       *apply
      </span>
     </code>
     family of functions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-vectorization-example">
       A vectorization example
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-tapply-function">
       The
       <code class="docutils literal notranslate">
        <span class="pre">
         tapply
        </span>
       </code>
       function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-by">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       by
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-replicate">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       replicate
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-plyr-and-ddply">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       plyr
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       ddply
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Practicals
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-vectorization-challenge">
     A vectorization challenge
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#errors-and-debugging">
   Errors and Debugging
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unit-testing">
     Unit testing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#debugging">
     Debugging
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#catching-errors">
     “Catching” errors
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#packages">
   Packages
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#building-your-own">
     Building your own
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   Practicals
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#is-florida-getting-warmer">
     Is Florida getting warmer?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#groupwork-practical-autocorrelation-in-florida-weather">
     Groupwork Practical: Autocorrelation in Florida weather
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#readings-and-resources">
   Readings and Resources
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#r-as-a-programming-language">
     R as a Programming language
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mathematical-modelling-and-stats-in-r">
     Mathematical modelling and Stats in R
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Debugging
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sweave-and-knitr-and-beyond">
     Sweave and knitr, and beyond
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="biological-computing-in-r">
<h1>Biological Computing in R<a class="headerlink" href="#biological-computing-in-r" title="Permalink to this headline">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>R is a freely available statistical software with strong  programming capabilities widely used by professional scientists around  the world. It was based on the commercial statistical software <code class="docutils literal notranslate"><span class="pre">S</span></code> by Robert Gentleman and Ross Ihaka. The first stable version appeared  in 2000. It was essentially designed for <em>programming</em> statistical analysis and data-mining. It became the standard tool for data analysis and visualization in biology in a matter of just 10 years or so. It is also frequently used for mathematical modelling in biology.</p>
<p>This chapter aims to lay down the foundations for you to use R for scientific computing in biology by exploiting it full potential as a fully featured object-oriented programming language. Specifically, this chapter aims at teaching you:</p>
<ul class="simple">
<li><p>Basic R syntax and programming conventions, assuming you have never set your eyes on R</p></li>
<li><p>Principles of data processing and exploration (including visualization) using R</p></li>
<li><p>Principles of clean and efficient programming using R</p></li>
<li><p>To generate publication quality graphics in R</p></li>
<li><p>To develop reproducible data analysis “work flows” so you (or anybody else) can run and re-run your analyses, graphics outputs and all, in R</p></li>
<li><p>To make R simulations more efficient using vectorization</p></li>
<li><p>To find and fix errors in R code using debugging</p></li>
<li><p>To make data wrangling and analyses more efficient and convenient using special packages</p></li>
<li><p>Some additional, advanced topics (accessing databases, building your own packages, etc.).</p></li>
</ul>
<section id="why-r">
<h3>Why R?<a class="headerlink" href="#why-r" title="Permalink to this headline">#</a></h3>
<p>There are many commercial statistical (minitab, SPSS, etc) software  packages in the world that are mouse-driven, warm, and friendly, and  have lots of statistical tests and plotting/graphing capabilities. Why not just use them? Here are some very good reasons:</p>
<ul class="simple">
<li><p>R has numerous tried and tested packages for data-handling and processing</p></li>
<li><p>R provides basically every statistical test you’ll ever need and is constantly being improved. You can tailor your analyses rather than trying to use the more limited options each statistical software package can offer.</p></li>
<li><p>R has excellent graphing and visualization capabilities and produce publication-quality graphics that can be re-produced with scripts – you won’t get <a class="reference external" href="https://en.wikipedia.org/wiki/Repetitive_strain_injury">RSI</a> mouse-clicking your way though graphing and re-graphing your data every time you change your analysis!</p></li>
<li><p>It also has good capabilities for mathematical calculations, including matrix algebra</p></li>
<li><p>R is scriptable, so you can build a perfectly repeatable record of your analysis. This in itself has several advantages:</p>
<ul>
<li><p>You can never replicate <em>exactly</em> the same analysis with all the same steps using a point-and-click approach/software. With R you can reproduce your full analysis for yourself (in the future!), your colleagues, your supervisor/employer, and any journal you might want to submit your work to.</p></li>
<li><p>You may need to rerun your analysis every time you get new data. Once you have it all in a R script, you can just rerun your     analysis and go home!</p></li>
<li><p>You may need to tweak your analysis many times (new data, supervisor changes mind, you change mind, paper reviewers want you do something differently). Having the analysis recorded as script then allows you to do so by revising the relevant parts of your analysis with relatively little pain.</p></li>
</ul>
</li>
<li><p>R is freely available for all common computer operating systems – if you want a copy on your laptop, help yourself  at the <a class="reference external" href="https://cran.r-project.org">CRAN website</a>.</p></li>
<li><p>Being able to program in R means you can develop and automate your own data handling, statistical analysis, and graphing/plotting, a set of skills you are likely to need in many, if not most careers paths.</p></li>
</ul>
<section id="would-you-ever-need-anything-other-than-r">
<h4>Would you ever need anything other than R?<a class="headerlink" href="#would-you-ever-need-anything-other-than-r" title="Permalink to this headline">#</a></h4>
<p>Being able to program R means you can develop and automate your statistical analyses and the generation of figures into a reproducible work flow. For many of you, using R as your only programming language will do the job. However, if your work also includes extensive numerical simulations, manipulation of very large matrices, bioinformatics, relational database access and manipulation, or web development, you will be better-off <em>also</em> knowing another programming language that is more versatile and computationally efficient (like Python or Julia).</p>
</section>
</section>
<section id="installing-r">
<h3>Installing R<a class="headerlink" href="#installing-r" title="Permalink to this headline">#</a></h3>
<p>If you are using a college computer, R will likely already be available.</p>
<p>Otherwise you can follow <a class="reference external" href="https://imperial-fons-computing.github.io/rstudio.html">these instructions</a> to install R on your own computer.</p>
<p>In particular, on Ubuntu Linux, it is as simple as typing the following in terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install r-base r-base-dev
</pre></div>
</div>
</section>
</section>
<section id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">#</a></h2>
<p>You should be using an IDE for R. Please re-visit the “To IDE or not to IDE” section of the <a class="reference internal" href="../intro.html"><span class="doc std std-doc">Introduction</span></a> if you are not familiar with IDEs.</p>
<p>Let’s briefly look at the bare-bones R interface and command line  interface (CLI), and then switch to an IDE like Visual Studio Code or RStudio.</p>
<p>Launch R (From Applications menu on Window or Mac, from terminal in  Linux/Ubuntu) — it should look something like this (on Linux/Ubuntu or Mac terminal):</p>
<hr class="docutils" />
<figure class="align-default" id="r-linux-console">
<a class="reference internal image-reference" href="../_images/R_Linux.png"><img alt="R in UNIX/Linux" src="../_images/R_Linux.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text"><strong>The R console in Linux/Unix.</strong></span><a class="headerlink" href="#r-linux-console" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Or like this (Windows “console”, similar in Mac):</p>
<hr class="docutils" />
<figure class="align-default" id="r-windows-console">
<a class="reference internal image-reference" href="../_images/R_terminal.jpg"><img alt="R in Windows" src="../_images/R_terminal.jpg" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text"><strong>The R console in Windows/Mac OS.</strong></span><a class="headerlink" href="#r-windows-console" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<hr class="docutils" />
<section id="r-basics">
<h2>R basics<a class="headerlink" href="#r-basics" title="Permalink to this headline">#</a></h2>
<p>Lets get started with some R basics. You will be working by entering R commands interactively at the R user prompt (<code class="docutils literal notranslate"><span class="pre">&gt;</span></code>). Up and down arrow keys scroll through your command history.</p>
<section id="useful-r-commands">
<h3>Useful R commands<a class="headerlink" href="#useful-r-commands" title="Permalink to this headline">#</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Command</p></th>
<th class="text-align:left head"><p>What it does</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">ls()</span></code></p></td>
<td class="text-align:left"><p>list all the variables in the work space</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">rm('a',</span> <span class="pre">'b')</span></code></p></td>
<td class="text-align:left"><p>remove variable(s) <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">rm(list=ls())</span></code></p></td>
<td class="text-align:left"><p>remove all variable(s)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">getwd()</span></code></p></td>
<td class="text-align:left"><p>get current working directory</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">setwd('Path')</span></code></p></td>
<td class="text-align:left"><p>set working directory to <code class="docutils literal notranslate"><span class="pre">Path</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">q()</span></code></p></td>
<td class="text-align:left"><p>quit R</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">?Command</span></code></p></td>
<td class="text-align:left"><p>show the documentation of <code class="docutils literal notranslate"><span class="pre">Command</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">??Keyword</span></code></p></td>
<td class="text-align:left"><p>search the all packages/functions with ‘Keyword’, “fuzzy search”</p></td>
</tr>
</tbody>
</table>
</section>
<section id="baby-steps">
<h3>Baby steps<a class="headerlink" href="#baby-steps" title="Permalink to this headline">#</a></h3>
<p>Like in any programming language, you will need to use “variables” to store information in a R session’s workspace. Each variable has a reserved location in your <a class="reference external" href="https://en.wikipedia.org/wiki/Random-access_memory">RAM</a>, and takes up “real estate” in it — that is when you create a variable you reserve some space in your computer’s memory.</p>
<p>★ Now, let’s try assigning a few variables in R and doing things to them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">&lt;-</span> <span class="m">4</span>  <span class="c1"># store 4 as variable a</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="c1"># display it</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">4</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="c1"># product</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">16</div></div>
</div>
<p>Store a variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">a_squared</span> <span class="o">&lt;-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">a</span> 
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike Python or most other programming languages, R uses the <code class="docutils literal notranslate"><span class="pre">&lt;-</span></code> <a class="reference external" href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/assignOps.html">operator to assign variables</a>. You can use <code class="docutils literal notranslate"><span class="pre">=</span></code> as well, but it does not work everywhere, so better to stick with <code class="docutils literal notranslate"><span class="pre">&lt;-</span></code>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">sqrt</span><span class="p">(</span><span class="n">a_squared</span><span class="p">)</span> <span class="c1"># square root</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">4</div></div>
</div>
<p>Build a vector with <code class="docutils literal notranslate"><span class="pre">c</span></code> (stands for “<code class="docutils literal notranslate"><span class="pre">c</span></code>oncatenate”):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="c1"># Display the vector-valued variable you created</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0</li><li>1</li><li>2</li><li>3</li><li>4</li></ol>
</div></div>
</div>
<p>Note that any text after a “#” is ignored by R, like in many other languages — handy for commenting.</p>
<p>*In general, please comment your code and scripts, for <em>everybody’s</em> sake. You will be amazed by how difficult it is to read and understand what a certain R script does (or any other script, for that matter) without judicious comments — even scripts you yourself wrote not so long ago!</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>The Concatenate function:</strong> <code class="docutils literal notranslate"><span class="pre">c()</span></code>(concatenate) is one of the most commonly used R functions because it is the default method for combining multiple arguments into a vector. To learn more about it, type <code class="docutils literal notranslate"><span class="pre">?c</span></code> at the R prompt and hit enter.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">is.vector</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="c1"># check if v&#39;s a vector</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">TRUE</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">mean</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="c1"># mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">2</div></div>
</div>
<p>Thus, a <em>vector</em> is like a single column or row in a <em>spreadsheet</em> (just like it is in <a class="reference internal" href="05-Python_I.html"><span class="doc std std-doc">Python</span></a>). Multiple vectors can be combined to make a matrix (the full spreadsheet).</p>
<p>This is one of many ways R stores and processes data. More on R data types and objects below.</p>
<p>A single value (any kind) is a vector object of length 1 by default. That’s why in the R console you see <code class="docutils literal notranslate"><span class="pre">[1]</span></code> before any single-value output (e.g., type <code class="docutils literal notranslate"><span class="pre">8</span></code>, and you will see <code class="docutils literal notranslate"><span class="pre">[1]</span> <span class="pre">8</span></code>).</p>
<p>Some examples of operations on vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">var</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="c1"># variance</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">2.5</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">median</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="c1"># median</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">2</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">sum</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="c1"># sum all elements</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">10</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">prod</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="m">1</span><span class="p">)</span> <span class="c1"># multiply</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">120</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">length</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="c1"># how many elements in the vector</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">5</div></div>
</div>
</section>
<section id="variable-names-and-tabbing">
<h3>Variable names and Tabbing<a class="headerlink" href="#variable-names-and-tabbing" title="Permalink to this headline">#</a></h3>
<p>In R, you can name variables in the following way to keep track of related variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">wing.width.cm</span> <span class="o">&lt;-</span> <span class="m">1.2</span> <span class="c1">#Using dot notation</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">wing.length.cm</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">4.7</span><span class="p">,</span> <span class="m">5.2</span><span class="p">,</span> <span class="m">4.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This can be handy; type:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">wing.</span>
</pre></div>
</div>
<p>And then hit the <code class="docutils literal notranslate"><span class="pre">tab</span></code>key to reveal all variables in that  category. This is nice — variable names should be as obvious as possible. However, they should not be over-long either! Good style and readability is more important than just convenient variable names.</p>
<p>In fact, R allows dots to be used in variable names of all objects (not just objects that are variables). For example, functions names can have dots in them as well, as you will see below with the <code class="docutils literal notranslate"><span class="pre">is.*</span></code> family (e.g., <code class="docutils literal notranslate"><span class="pre">is.infinite()</span></code>, <code class="docutils literal notranslate"><span class="pre">is.nan()</span></code>, etc.).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Following a consistent style for different elements of your R code (synttax, conditionals, functions, etc) is important. The tidyverse <a class="reference external" href="https://style.tidyverse.org/index.html">style guide</a>  is recommended. While should keep going back to difefrent sections of the syule gude as you learn new topics. Here, for starters, have a look at <a class="reference external" href="https://style.tidyverse.org/syntax.html">naming conventions</a>.</p>
</div>
</section>
<section id="operators">
<h3>Operators<a class="headerlink" href="#operators" title="Permalink to this headline">#</a></h3>
<p>The usual operators are available in R:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Operator</p></th>
<th class="text-align:left head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">+</span></code></p></td>
<td class="text-align:left"><p>Addition</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td class="text-align:left"><p>Subtraction</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">*</span></code></p></td>
<td class="text-align:left"><p>Multiplication</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">/</span></code></p></td>
<td class="text-align:left"><p>Division</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">^</span></code></p></td>
<td class="text-align:left"><p>Power</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">%%</span></code></p></td>
<td class="text-align:left"><p>Modulo</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">%/%</span></code></p></td>
<td class="text-align:left"><p>Integer division</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">==</span></code></p></td>
<td class="text-align:left"><p>Equals</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">!=</span></code></p></td>
<td class="text-align:left"><p>Differs</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">&gt;</span></code></p></td>
<td class="text-align:left"><p>Greater</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">&gt;=</span></code></p></td>
<td class="text-align:left"><p>Greater or equal</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">&amp;</span></code></p></td>
<td class="text-align:left"><p>Logical and</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>`</p></td>
<td class="text-align:left"><p>`</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">!</span></code></p></td>
<td class="text-align:left"><p>Logical not</p></td>
</tr>
</tbody>
</table>
</section>
<section id="when-things-go-wrong">
<h3>When things go wrong<a class="headerlink" href="#when-things-go-wrong" title="Permalink to this headline">#</a></h3>
<p>Here are some common syntax errors that you might run into in R, especially when you just beginning to learn this language:</p>
<ul class="simple">
<li><p>Missing a closing bracket leads to continuation line, which looks something like this, with a <code class="docutils literal notranslate"><span class="pre">+</span></code> at the end:</p></li>
</ul>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">1</span> <span class="o">+</span> <span class="p">(</span><span class="m">2</span> <span class="o">*</span> <span class="m">3</span><span class="p">)</span>
<span class="o">+</span> 
</pre></div>
</div>
<p>Hit <code class="docutils literal notranslate"><span class="pre">Ctrl-C</span></code>(UNIX terminal or base R command line) or ESC (in in RStudio) or keep typing!</p>
<ul class="simple">
<li><p>Too many parentheses; for example, <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">+</span> <span class="pre">(2*3))</span></code></p></li>
<li><p>Wrong or mismatched brackets (see next subsection)</p></li>
<li><p>Mixing double and single quotes will also give you an error</p></li>
</ul>
<p>When things are taking too long and the R console seems frozen, try <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">C</span></code> (UNIX terminal or base R command line) or ESC (in RStudio) to force an exit from whatever is going on.</p>
</section>
<section id="types-of-parentheses">
<h3>Types of parentheses<a class="headerlink" href="#types-of-parentheses" title="Permalink to this headline">#</a></h3>
<p>R has specific uses for different types of Parentheses type that you need to get used to:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Parentheses type</p></th>
<th class="text-align:left head"><p>What it does</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">f(3,4)</span></code></p></td>
<td class="text-align:left"><p>call the function (or command) f, with the arguments 3 &amp; 4.</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">(b*c)</span></code></p></td>
<td class="text-align:left"><p>to enforce order over which statements or calculations are executed. Here <code class="docutils literal notranslate"><span class="pre">(b*c)</span></code>is executed before adding to <code class="docutils literal notranslate"><span class="pre">a</span></code>. Here is an alternative order: <code class="docutils literal notranslate"><span class="pre">(a</span> <span class="pre">+</span> <span class="pre">b)*c</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">{expr1;</span> <span class="pre">expr2;...exprn}</span></code></p></td>
<td class="text-align:left"><p>group a set of expressions or commands into one compound expression. Value returned is value of last expression; used in building function, loops, and conditionals (more on these soon!).</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">x[4]</span></code></p></td>
<td class="text-align:left"><p>get the 4th element of the vector <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">li[[3]]</span></code></p></td>
<td class="text-align:left"><p>get the 3rd element of some list <code class="docutils literal notranslate"><span class="pre">li</span></code>, and return it.(compare with <code class="docutils literal notranslate"><span class="pre">li[3]</span></code>, which returns a list with just the 3rd element inside). More on lists in next section.</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">li</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">class</span><span class="p">(</span><span class="n">li</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'list'</div></div>
</div>
</section>
</section>
<section id="variable-types">
<h2>Variable types<a class="headerlink" href="#variable-types" title="Permalink to this headline">#</a></h2>
<p>There are different kinds of data variable types in R, but you will basically need to know four for most of your work: integer, float (or “numeric”, including real numbers), string (or “character”, e.g.,
text), and Boolean (“logical”; <code class="docutils literal notranslate"><span class="pre">True</span></code>or <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>).</p>
<p>Try this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">&lt;-</span> <span class="kc">TRUE</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">TRUE</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">class</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'logical'</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">class()</span></code> function tells you what type of variable any object in the workspace is.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">&lt;-</span> <span class="m">3.2</span>
<span class="nf">class</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'numeric'</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">&lt;-</span> <span class="m">2L</span>
<span class="nf">class</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'integer'</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">&lt;-</span> <span class="s">&quot;A string&quot;</span>
<span class="nf">class</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'character'</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">&lt;-</span> <span class="kc">NA</span>
<span class="nf">class</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'logical'</div></div>
</div>
<p>Also, the <code class="docutils literal notranslate"><span class="pre">is.*</span></code> family of functions allow you to check if a variable is a specific in R:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">is.na</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">TRUE</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">&lt;-</span> <span class="m">0</span><span class="o">/</span><span class="m">0</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">NaN</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">is.nan</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">TRUE</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">&lt;-</span> <span class="m">5</span><span class="o">/</span><span class="m">0</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">Inf</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">is.nan</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">FALSE</div></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Beware of the difference between <code class="docutils literal notranslate"><span class="pre">NA</span></code> (<code class="docutils literal notranslate"><span class="pre">N</span></code>ot<code class="docutils literal notranslate"> <span class="pre">A</span></code>vailable) and <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (<code class="docutils literal notranslate"><span class="pre">N</span></code>ot<code class="docutils literal notranslate"> <span class="pre">a</span> <span class="pre">N</span></code>umber). R will use <code class="docutils literal notranslate"><span class="pre">NA</span></code>to represent/identify missing values in data or outputs, while <code class="docutils literal notranslate"><span class="pre">NaN</span></code>represent nonsense values (e.g., 0/0) that cannot be represented as a number or some other data type.</p>
<p>See what R has to say about this: try <code class="docutils literal notranslate"><span class="pre">?is.nan</span></code>, <code class="docutils literal notranslate"><span class="pre">?is.na</span></code>, <code class="docutils literal notranslate"><span class="pre">?NA</span></code>, <code class="docutils literal notranslate"><span class="pre">?NaN</span></code>in the R commandline (one at a time!).</p>
<p>There are also <code class="docutils literal notranslate"><span class="pre">Inf</span></code> (Infinity, e.g., 1/0), and <code class="docutils literal notranslate"><span class="pre">NULL</span></code> (variable not set) value types. Look these up as well using <code class="docutils literal notranslate"><span class="pre">?</span></code>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">is.infinite</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">TRUE</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">is.finite</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">FALSE</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">is.finite</span><span class="p">(</span><span class="m">0</span><span class="o">/</span><span class="m">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">FALSE</div></div>
</div>
<section id="type-conversions-and-special-values">
<h3>Type Conversions and Special Values<a class="headerlink" href="#type-conversions-and-special-values" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">as.*</span></code> commands all convert a variable from one type to another. Try out the following examples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">as.integer</span><span class="p">(</span><span class="m">3.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">3</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">as.numeric</span><span class="p">(</span><span class="m">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">4</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">as.roman</span><span class="p">(</span><span class="m">155</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] CLV
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">as.character</span><span class="p">(</span><span class="m">155</span><span class="p">)</span>  <span class="c1"># same as converting to string</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'155'</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">as.logical</span><span class="p">(</span><span class="m">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">TRUE</div></div>
</div>
<p><em>What just happened?!</em> R maps all values other than <code class="docutils literal notranslate"><span class="pre">0</span></code> to logical <code class="docutils literal notranslate"><span class="pre">True</span></code>, and <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>. This can be useful in some cases, for example, when you want to convert all your data to Presence-Absence only.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">as.logical</span><span class="p">(</span><span class="m">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">FALSE</div></div>
</div>
<p>Also, <em>keep an eye out for <a class="reference external" href="https://en.wikipedia.org/wiki/Scientific_notation">E notation</a> in outputs of R functions for statistical analyses, and learn to interpret numbers formatted this way.</em> R uses E notation in outputs of statistical tests to display  very large or small numbers. If you are not used to different  representations of long numbers, the E notation might be  confusing.</p>
<p>Try this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="m">1E4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">10000</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="m">1e4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">10000</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="m">5e-2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.05</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="m">1E4</span><span class="o">^</span><span class="m">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">1e+08</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="o">/</span> <span class="m">3</span> <span class="o">/</span> <span class="m">1e8</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">3.33333333333333e-09</div></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Boolean arguments in R</strong>: In <code class="docutils literal notranslate"><span class="pre">R</span></code>, you can use <code class="docutils literal notranslate"><span class="pre">F</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code> for boolean <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> and <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> respectively. To see this, type</p>
<p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&lt;-</span> <span class="pre">T</span></code></p>
<p>in the R commandline, and then see what R returns when you type <code class="docutils literal notranslate"><span class="pre">a</span></code>. Using <code class="docutils literal notranslate"><span class="pre">F</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code> for boolean <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> and <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> respectively is not necessarily good practice, but be aware that this option exists.</p>
</div>
</section>
</section>
<section id="r-data-structures">
<h2>R Data Structures<a class="headerlink" href="#r-data-structures" title="Permalink to this headline">#</a></h2>
<p>R comes with different built-in structures (objects) for data storage and manipulation. Mastering these, and knowing which one to use when will help you write better, more efficient programs and also handle diverse datasets (numbers, counts, names, dates, etc).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Data “structures” vs. “objects” in R</strong>: You will often see the terms “object” and “data structure” used in this and other chapters. These two have a very distinct meaning in object-oriented programming (OOP) languages like R and Python. A data structure is just a “dumb” container for data (e.g., a vector). An object, on the other hand can be a data structure, but also any other variable or a function in your R environment. R, being an OOP language, converts everything in the current environment to an object so that it knows what to do with each such entity — each object type has its own set of rules for operations and manipulations that R uses when interpreting your commands.</p>
</div>
<section id="vectors">
<h3>Vectors<a class="headerlink" href="#vectors" title="Permalink to this headline">#</a></h3>
<p>The Vector, which you have already seen above, is a fundamental data object / structure in R. Scalars (single data values) are treated as vector of length 1. <em>A vector is like a single column or row in a spreadsheet.</em></p>
<p>★ Now get back into R (if you somehow quit R using <code class="docutils literal notranslate"><span class="pre">q()</span></code>or something else), and try this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">&lt;-</span> <span class="m">5</span>
<span class="nf">is.vector</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">TRUE</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.02</span><span class="p">,</span> <span class="m">0.5</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="n">v2</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;bc&quot;</span><span class="p">,</span> <span class="s">&quot;def&quot;</span><span class="p">,</span> <span class="s">&quot;ghij&quot;</span><span class="p">)</span>
<span class="n">v3</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v1</span><span class="p">;</span><span class="n">v2</span><span class="p">;</span><span class="n">v3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0.02</li><li>0.5</li><li>1</li></ol>
</div><div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'a'</li><li>'bc'</li><li>'def'</li><li>'ghij'</li></ol>
</div><div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>TRUE</li><li>TRUE</li><li>FALSE</li></ol>
</div></div>
</div>
<p>R vectors can only store data of a single type (e.g., all numeric or all character). If you try to combine different types, R will homogenize everything to the same data type. To see this, try the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.02</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="n">v1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0.02</li><li>1</li><li>1</li></ol>
</div></div>
</div>
<p>TRUE gets converted to 1.00!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.02</span><span class="p">,</span> <span class="s">&quot;Mary&quot;</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="n">v1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'0.02'</li><li>'Mary'</li><li>'1'</li></ol>
</div></div>
</div>
<p>Everything gets converted to text!</p>
<p>Basically, the function <code class="docutils literal notranslate"><span class="pre">c</span></code> “coerces” arguments that are of mixed types (strings/text, real numbers, logical arguments, etc) to a common type.</p>
</section>
<section id="matrices-and-arrays">
<span id="r-matrices"></span><h3>Matrices and arrays<a class="headerlink" href="#matrices-and-arrays" title="Permalink to this headline">#</a></h3>
<p>A R “matrix” is a 2 dimensional vector (has both rows and columns) and a “array” can store data in more than two dimensions (e.g., a stack of 2-D matrices).</p>
<p>R has many functions to build and manipulate matrices and arrays.</p>
<p>Try this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mat1</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">25</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
<span class="n">mat1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A matrix: 5 × 5 of type int</caption>
<tbody>
	<tr><td>1</td><td> 6</td><td>11</td><td>16</td><td>21</td></tr>
	<tr><td>2</td><td> 7</td><td>12</td><td>17</td><td>22</td></tr>
	<tr><td>3</td><td> 8</td><td>13</td><td>18</td><td>23</td></tr>
	<tr><td>4</td><td> 9</td><td>14</td><td>19</td><td>24</td></tr>
	<tr><td>5</td><td>10</td><td>15</td><td>20</td><td>25</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Note that the output in your terminal or console will be more like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="n">mat1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     [,1] [,2] [,3] [,4] [,5]
[1,]    1    6   11   16   21
[2,]    2    7   12   17   22
[3,]    3    8   13   18   23
[4,]    4    9   14   19   24
[5,]    5   10   15   20   25
</pre></div>
</div>
</div>
</div>
<p>(even if you don’t use the <code class="docutils literal notranslate"><span class="pre">print()</span></code> command)</p>
<p>The output looks different above because the R code is running in a jupyter notebook.</p>
<p>Now try this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mat1</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">25</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="n">byrow</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">mat1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A matrix: 5 × 5 of type int</caption>
<tbody>
	<tr><td> 1</td><td> 2</td><td> 3</td><td> 4</td><td> 5</td></tr>
	<tr><td> 6</td><td> 7</td><td> 8</td><td> 9</td><td>10</td></tr>
	<tr><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td></tr>
	<tr><td>16</td><td>17</td><td>18</td><td>19</td><td>20</td></tr>
	<tr><td>21</td><td>22</td><td>23</td><td>24</td><td>25</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>That is, you can order the elements of a matrix by row instead of column (default).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">dim</span><span class="p">(</span><span class="n">mat1</span><span class="p">)</span> <span class="c1">#get the size of the matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>5</li><li>5</li></ol>
</div></div>
</div>
<p>To make an array consisting of two 5<span class="math notranslate nohighlight">\(\times\)</span>5 matrices containing the integers 1-50:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">arr1</span> <span class="o">&lt;-</span> <span class="nf">array</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">50</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
<span class="n">arr1</span><span class="p">[,,</span><span class="m">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A matrix: 5 × 5 of type int</caption>
<tbody>
	<tr><td>1</td><td> 6</td><td>11</td><td>16</td><td>21</td></tr>
	<tr><td>2</td><td> 7</td><td>12</td><td>17</td><td>22</td></tr>
	<tr><td>3</td><td> 8</td><td>13</td><td>18</td><td>23</td></tr>
	<tr><td>4</td><td> 9</td><td>14</td><td>19</td><td>24</td></tr>
	<tr><td>5</td><td>10</td><td>15</td><td>20</td><td>25</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>, , 1

     [,1] [,2] [,3] [,4] [,5]
[1,]    1    6   11   16   21
[2,]    2    7   12   17   22
[3,]    3    8   13   18   23
[4,]    4    9   14   19   24
[5,]    5   10   15   20   25

, , 2

     [,1] [,2] [,3] [,4] [,5]
[1,]   26   31   36   41   46
[2,]   27   32   37   42   47
[3,]   28   33   38   43   48
[4,]   29   34   39   44   49
[5,]   30   35   40   45   50
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">arr1</span><span class="p">[,,</span><span class="m">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A matrix: 5 × 5 of type int</caption>
<tbody>
	<tr><td>26</td><td>31</td><td>36</td><td>41</td><td>46</td></tr>
	<tr><td>27</td><td>32</td><td>37</td><td>42</td><td>47</td></tr>
	<tr><td>28</td><td>33</td><td>38</td><td>43</td><td>48</td></tr>
	<tr><td>29</td><td>34</td><td>39</td><td>44</td><td>49</td></tr>
	<tr><td>30</td><td>35</td><td>40</td><td>45</td><td>50</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Just like R vectors, R matrices and arrays have to be of a homogeneous type, and R will do the same sort of type homogenization you saw for R vectors above.</p>
<p>Try inserting a text value in <code class="docutils literal notranslate"><span class="pre">mat1</span></code>and see what happens:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mat1</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="s">&quot;one&quot;</span>
<span class="n">mat1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A matrix: 5 × 5 of type chr</caption>
<tbody>
	<tr><td>one</td><td>2 </td><td>3 </td><td>4 </td><td>5 </td></tr>
	<tr><td>6  </td><td>7 </td><td>8 </td><td>9 </td><td>10</td></tr>
	<tr><td>11 </td><td>12</td><td>13</td><td>14</td><td>15</td></tr>
	<tr><td>16 </td><td>17</td><td>18</td><td>19</td><td>20</td></tr>
	<tr><td>21 </td><td>22</td><td>23</td><td>24</td><td>25</td></tr>
</tbody>
</table>
</div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">mat1</span></code> went from being <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">matrix:</span> <span class="pre">5</span> <span class="pre">×</span> <span class="pre">5</span> <span class="pre">of</span> <span class="pre">type</span> <span class="pre">int</span></code> to <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">matrix:</span> <span class="pre">5</span> <span class="pre">×</span> <span class="pre">5</span> <span class="pre">of</span> <span class="pre">type</span> <span class="pre">chr</span></code>. That is, inserting a string in one location converted all the elements of the matrix to the <code class="docutils literal notranslate"><span class="pre">chr</span></code> (string) data type.</p>
<p>Thus R’s matrix and array are similar to Python’s <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array and matrix data structures.</p>
</section>
<section id="data-frames">
<h3>Data frames<a class="headerlink" href="#data-frames" title="Permalink to this headline">#</a></h3>
<p>This is a very important data structure in R. Unlike matrices and vectors, R data frames can store data in which each column contains a different data type (e.g., numbers, strings, boolean) or even a combination of data types, just like a standard spreadsheet. Indeed, the dataframe data type was built to emulate some of the convenient properties of spreadsheets. Many statistical and plotting functions and packages in R naturally use data frames.</p>
<p>Let’s build and manipulate a dataframe. First create three vectors:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Under the hood, a R data frame is in fact a <code class="docutils literal notranslate"><span class="pre">list</span></code> of equal-length <code class="docutils literal notranslate"><span class="pre">vector</span></code>s.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">Col1</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="m">10</span>
<span class="n">Col1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">Col2</span> <span class="o">&lt;-</span> <span class="kc">LETTERS</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">]</span>
<span class="n">Col2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'A'</li><li>'B'</li><li>'C'</li><li>'D'</li><li>'E'</li><li>'F'</li><li>'G'</li><li>'H'</li><li>'I'</li><li>'J'</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">Col3</span> <span class="o">&lt;-</span> <span class="nf">runif</span><span class="p">(</span><span class="m">10</span><span class="p">)</span> <span class="c1"># 10 random numbers from a uniform distribution</span>
<span class="n">Col3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0.938413555268198</li><li>0.426268232986331</li><li>0.352635570103303</li><li>0.420346662169322</li><li>0.309041227446869</li><li>0.0709800566546619</li><li>0.294151729205623</li><li>0.802815589588135</li><li>0.706063920864835</li><li>0.974233828950673</li></ol>
</div></div>
</div>
<p>Now combine them into a dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyDF</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">Col1</span><span class="p">,</span> <span class="n">Col2</span><span class="p">,</span> <span class="n">Col3</span><span class="p">)</span>
<span class="n">MyDF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 10 × 3</caption>
<thead>
	<tr><th scope=col>Col1</th><th scope=col>Col2</th><th scope=col>Col3</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td> 1</td><td>A</td><td>0.93841356</td></tr>
	<tr><td> 2</td><td>B</td><td>0.42626823</td></tr>
	<tr><td> 3</td><td>C</td><td>0.35263557</td></tr>
	<tr><td> 4</td><td>D</td><td>0.42034666</td></tr>
	<tr><td> 5</td><td>E</td><td>0.30904123</td></tr>
	<tr><td> 6</td><td>F</td><td>0.07098006</td></tr>
	<tr><td> 7</td><td>G</td><td>0.29415173</td></tr>
	<tr><td> 8</td><td>H</td><td>0.80281559</td></tr>
	<tr><td> 9</td><td>I</td><td>0.70606392</td></tr>
	<tr><td>10</td><td>J</td><td>0.97423383</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Again, this output looks different from your terminal/console output because these commands are running in a Jupyter notebook.</p>
<p>Your output will look like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="n">MyDF</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Col1 Col2       Col3
1     1    A 0.93841356
2     2    B 0.42626823
3     3    C 0.35263557
4     4    D 0.42034666
5     5    E 0.30904123
6     6    F 0.07098006
7     7    G 0.29415173
8     8    H 0.80281559
9     9    I 0.70606392
10   10    J 0.97423383
</pre></div>
</div>
</div>
</div>
<p>You can easily assign names to the columns of dataframes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">names</span><span class="p">(</span><span class="n">MyDF</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;MyFirstColumn&quot;</span><span class="p">,</span> <span class="s">&quot;My Second Column&quot;</span><span class="p">,</span> <span class="s">&quot;My.Third.Column&quot;</span><span class="p">)</span>
<span class="n">MyDF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 10 × 3</caption>
<thead>
	<tr><th scope=col>MyFirstColumn</th><th scope=col>My Second Column</th><th scope=col>My.Third.Column</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td> 1</td><td>A</td><td>0.93841356</td></tr>
	<tr><td> 2</td><td>B</td><td>0.42626823</td></tr>
	<tr><td> 3</td><td>C</td><td>0.35263557</td></tr>
	<tr><td> 4</td><td>D</td><td>0.42034666</td></tr>
	<tr><td> 5</td><td>E</td><td>0.30904123</td></tr>
	<tr><td> 6</td><td>F</td><td>0.07098006</td></tr>
	<tr><td> 7</td><td>G</td><td>0.29415173</td></tr>
	<tr><td> 8</td><td>H</td><td>0.80281559</td></tr>
	<tr><td> 9</td><td>I</td><td>0.70606392</td></tr>
	<tr><td>10</td><td>J</td><td>0.97423383</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>And unlike matrices, you can access the contents of data frames by naming the columns directly using a $ sign:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyDF</span><span class="o">$</span><span class="n">MyFirstColumn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li></ol>
</div></div>
</div>
<p>But don’t use spaces in column names! Try this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyDF</span><span class="o">$</span><span class="n">My</span> <span class="n">Second</span> <span class="n">Column</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>Error in parse(text = x, srcfile = src): &lt;text&gt;:1:9: unexpected symbol
1: MyDF$My Second
            ^
Traceback:
</pre></div>
</div>
</div>
</div>
<p>That gives an error, because R cannot handle spaces in column names easily.</p>
<p>So replace that column name using the <code class="docutils literal notranslate"><span class="pre">colnames</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">colnames</span><span class="p">(</span><span class="n">MyDF</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'MyFirstColumn'</li><li>'My Second Column'</li><li>'My.Third.Column'</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">colnames</span><span class="p">(</span><span class="n">MyDF</span><span class="p">)[</span><span class="m">2</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="s">&quot;MySecondColumn&quot;</span>
<span class="n">MyDF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 10 × 3</caption>
<thead>
	<tr><th scope=col>MyFirstColumn</th><th scope=col>MySecondColumn</th><th scope=col>My.Third.Column</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td> 1</td><td>A</td><td>0.93841356</td></tr>
	<tr><td> 2</td><td>B</td><td>0.42626823</td></tr>
	<tr><td> 3</td><td>C</td><td>0.35263557</td></tr>
	<tr><td> 4</td><td>D</td><td>0.42034666</td></tr>
	<tr><td> 5</td><td>E</td><td>0.30904123</td></tr>
	<tr><td> 6</td><td>F</td><td>0.07098006</td></tr>
	<tr><td> 7</td><td>G</td><td>0.29415173</td></tr>
	<tr><td> 8</td><td>H</td><td>0.80281559</td></tr>
	<tr><td> 9</td><td>I</td><td>0.70606392</td></tr>
	<tr><td>10</td><td>J</td><td>0.97423383</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>But using dots in column names is OK (just as it is for variable names):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyDF</span><span class="o">$</span><span class="n">My.Third.Column</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0.938413555268198</li><li>0.426268232986331</li><li>0.352635570103303</li><li>0.420346662169322</li><li>0.309041227446869</li><li>0.0709800566546619</li><li>0.294151729205623</li><li>0.802815589588135</li><li>0.706063920864835</li><li>0.974233828950673</li></ol>
</div></div>
</div>
<p>You can also access elements by using numerical indexing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyDF</span><span class="p">[,</span><span class="m">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li></ol>
</div></div>
</div>
<p>That is, you asked R to return values of <code class="docutils literal notranslate"><span class="pre">MyDF</span></code> in all Rows (therefore, nothing before the comma), and the first column (<code class="docutils literal notranslate"><span class="pre">1</span></code> after the comma).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyDF</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">1</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyDF</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;MyFirstColumn&quot;</span><span class="p">,</span><span class="s">&quot;My.Third.Column&quot;</span><span class="p">)]</span> <span class="c1"># show two specific columns only</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 10 × 2</caption>
<thead>
	<tr><th scope=col>MyFirstColumn</th><th scope=col>My.Third.Column</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td> 1</td><td>0.93841356</td></tr>
	<tr><td> 2</td><td>0.42626823</td></tr>
	<tr><td> 3</td><td>0.35263557</td></tr>
	<tr><td> 4</td><td>0.42034666</td></tr>
	<tr><td> 5</td><td>0.30904123</td></tr>
	<tr><td> 6</td><td>0.07098006</td></tr>
	<tr><td> 7</td><td>0.29415173</td></tr>
	<tr><td> 8</td><td>0.80281559</td></tr>
	<tr><td> 9</td><td>0.70606392</td></tr>
	<tr><td>10</td><td>0.97423383</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>You can check whether a particular object is a dataframe data structure with:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">class</span><span class="p">(</span><span class="n">MyDF</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'data.frame'</div></div>
</div>
<p>You can check the structure of a dataframe with <code class="docutils literal notranslate"><span class="pre">str()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">str</span><span class="p">(</span><span class="n">MyDF</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;data.frame&#39;:	10 obs. of  3 variables:
 $ MyFirstColumn  : int  1 2 3 4 5 6 7 8 9 10
 $ MySecondColumn : chr  &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...
 $ My.Third.Column: num  0.938 0.426 0.353 0.42 0.309 ...
</pre></div>
</div>
</div>
</div>
<p>You can print the column names and top few rows with <code class="docutils literal notranslate"><span class="pre">head()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">head</span><span class="p">(</span><span class="n">MyDF</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 3</caption>
<thead>
	<tr><th></th><th scope=col>MyFirstColumn</th><th scope=col>MySecondColumn</th><th scope=col>My.Third.Column</th></tr>
	<tr><th></th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>1</td><td>A</td><td>0.93841356</td></tr>
	<tr><th scope=row>2</th><td>2</td><td>B</td><td>0.42626823</td></tr>
	<tr><th scope=row>3</th><td>3</td><td>C</td><td>0.35263557</td></tr>
	<tr><th scope=row>4</th><td>4</td><td>D</td><td>0.42034666</td></tr>
	<tr><th scope=row>5</th><td>5</td><td>E</td><td>0.30904123</td></tr>
	<tr><th scope=row>6</th><td>6</td><td>F</td><td>0.07098006</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>And the bottom few rows with <code class="docutils literal notranslate"><span class="pre">tail()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">tail</span><span class="p">(</span><span class="n">MyDF</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 3</caption>
<thead>
	<tr><th></th><th scope=col>MyFirstColumn</th><th scope=col>MySecondColumn</th><th scope=col>My.Third.Column</th></tr>
	<tr><th></th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>5</th><td> 5</td><td>E</td><td>0.30904123</td></tr>
	<tr><th scope=row>6</th><td> 6</td><td>F</td><td>0.07098006</td></tr>
	<tr><th scope=row>7</th><td> 7</td><td>G</td><td>0.29415173</td></tr>
	<tr><th scope=row>8</th><td> 8</td><td>H</td><td>0.80281559</td></tr>
	<tr><th scope=row>9</th><td> 9</td><td>I</td><td>0.70606392</td></tr>
	<tr><th scope=row>10</th><td>10</td><td>J</td><td>0.97423383</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>The Factor data type</strong>: R has a special data type called “factor”. Different values in this data type are called “levels”. This data type is used to identify “grouping variables” such as columns in a dataframe that contain  experimental treatments. This is convenient for statistical analyses using one of the many plotting and statistical commands or routines available in R, which have been written to interpret the <code class="docutils literal notranslate"><span class="pre">factor</span></code> data type as such and use it to automatically compare subgroups in the data. More on this later, when we delve into analyses (including visualization) in R.</p>
</div>
</section>
<section id="lists">
<h3>Lists<a class="headerlink" href="#lists" title="Permalink to this headline">#</a></h3>
<p>A list is used to collect a group of data objects of different sizes and types (e.g., one whole data frame and one vector can both be in a single list). It is simply an ordered collection of objects (that can be variables).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The outputs of many statistical functions in R are lists (e.g. linear model fitting using <code class="docutils literal notranslate"><span class="pre">lm()</span></code>), to return all relevant information in one output object. So you need to know how to unpack and manipulate lists.</p>
</div>
<p>As a budding multilingual quantitative biologist, you should not be perturbed by the fact that a <code class="docutils literal notranslate"><span class="pre">list</span></code> is a very different data structure in python vs R. It will take some practice — sometimes the same word means different things in different human languages too!</p>
<p>Try this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyList</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Quercus robur&quot;</span><span class="p">,</span><span class="s">&quot;Fraxinus excelsior&quot;</span><span class="p">),</span> <span class="n">age</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">123</span><span class="p">,</span> <span class="m">84</span><span class="p">))</span>
<span class="n">MyList</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><dl>
	<dt>$species</dt>
		<dd><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'Quercus robur'</li><li>'Fraxinus excelsior'</li></ol>
</dd>
	<dt>$age</dt>
		<dd><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>123</li><li>84</li></ol>
</dd>
</dl>
</div></div>
</div>
<p>You can access contents of a list item using number of the item instead of name using nested square brackets:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyList</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'Quercus robur'</li><li>'Fraxinus excelsior'</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyList</span><span class="p">[[</span><span class="m">1</span><span class="p">]][</span><span class="m">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'Quercus robur'</div></div>
</div>
<p>or using the name in either this way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyList</span><span class="o">$</span><span class="n">species</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'Quercus robur'</li><li>'Fraxinus excelsior'</li></ol>
</div></div>
</div>
<p>or this way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyList</span><span class="p">[[</span><span class="s">&quot;species&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'Quercus robur'</li><li>'Fraxinus excelsior'</li></ol>
</div></div>
</div>
<p>And to access a specific element inside a list’s item</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyList</span><span class="o">$</span><span class="n">species</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'Quercus robur'</div></div>
</div>
<p>A more complex list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pop1</span><span class="o">&lt;-</span><span class="nf">list</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="s">&#39;Cancer magister&#39;</span><span class="p">,</span>
           <span class="n">latitude</span><span class="o">=</span><span class="m">48.3</span><span class="p">,</span><span class="n">longitude</span><span class="o">=</span><span class="m">-123.1</span><span class="p">,</span>
           <span class="n">startyr</span><span class="o">=</span><span class="m">1980</span><span class="p">,</span><span class="n">endyr</span><span class="o">=</span><span class="m">1985</span><span class="p">,</span>
           <span class="n">pop</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">303</span><span class="p">,</span><span class="m">402</span><span class="p">,</span><span class="m">101</span><span class="p">,</span><span class="m">607</span><span class="p">,</span><span class="m">802</span><span class="p">,</span><span class="m">35</span><span class="p">))</span>
<span class="n">pop1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><dl>
	<dt>$species</dt>
		<dd>'Cancer magister'</dd>
	<dt>$latitude</dt>
		<dd>48.3</dd>
	<dt>$longitude</dt>
		<dd>-123.1</dd>
	<dt>$startyr</dt>
		<dd>1980</dd>
	<dt>$endyr</dt>
		<dd>1985</dd>
	<dt>$pop</dt>
		<dd><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>303</li><li>402</li><li>101</li><li>607</li><li>802</li><li>35</li></ol>
</dd>
</dl>
</div></div>
</div>
<p>You can build lists of lists too:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pop1</span><span class="o">&lt;-</span><span class="nf">list</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="m">19</span><span class="p">,</span><span class="n">long</span><span class="o">=</span><span class="m">57</span><span class="p">,</span>
           <span class="n">pop</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">100</span><span class="p">,</span><span class="m">101</span><span class="p">,</span><span class="m">99</span><span class="p">))</span>
<span class="n">pop2</span><span class="o">&lt;-</span><span class="nf">list</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="m">56</span><span class="p">,</span><span class="n">long</span><span class="o">=</span><span class="m">-120</span><span class="p">,</span>
           <span class="n">pop</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">7</span><span class="p">,</span><span class="m">7</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="n">pop3</span><span class="o">&lt;-</span><span class="nf">list</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="m">32</span><span class="p">,</span><span class="n">long</span><span class="o">=</span><span class="m">-10</span><span class="p">,</span>
           <span class="n">pop</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">12</span><span class="p">,</span><span class="m">11</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">14</span><span class="p">))</span>
<span class="n">pops</span><span class="o">&lt;-</span><span class="nf">list</span><span class="p">(</span><span class="n">sp1</span><span class="o">=</span><span class="n">pop1</span><span class="p">,</span><span class="n">sp2</span><span class="o">=</span><span class="n">pop2</span><span class="p">,</span><span class="n">sp3</span><span class="o">=</span><span class="n">pop3</span><span class="p">)</span>
<span class="n">pops</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><dl>
	<dt>$sp1</dt>
		<dd><dl>
	<dt>$lat</dt>
		<dd>19</dd>
	<dt>$long</dt>
		<dd>57</dd>
	<dt>$pop</dt>
		<dd><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>100</li><li>101</li><li>99</li></ol>
</dd>
</dl>
</dd>
	<dt>$sp2</dt>
		<dd><dl>
	<dt>$lat</dt>
		<dd>56</dd>
	<dt>$long</dt>
		<dd>-120</dd>
	<dt>$pop</dt>
		<dd><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1</li><li>4</li><li>7</li><li>7</li><li>2</li><li>1</li><li>2</li></ol>
</dd>
</dl>
</dd>
	<dt>$sp3</dt>
		<dd><dl>
	<dt>$lat</dt>
		<dd>32</dd>
	<dt>$long</dt>
		<dd>-10</dd>
	<dt>$pop</dt>
		<dd><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>12</li><li>11</li><li>2</li><li>1</li><li>14</li></ol>
</dd>
</dl>
</dd>
</dl>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pops</span><span class="o">$</span><span class="n">sp1</span> <span class="c1"># check out species 1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><dl>
	<dt>$lat</dt>
		<dd>19</dd>
	<dt>$long</dt>
		<dd>57</dd>
	<dt>$pop</dt>
		<dd><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>100</li><li>101</li><li>99</li></ol>
</dd>
</dl>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pops</span><span class="o">$</span><span class="n">sp1</span><span class="p">[</span><span class="s">&quot;pop&quot;</span><span class="p">]</span> <span class="c1"># sp1&#39;s population sizes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><strong>$pop</strong> = <style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>100</li><li>101</li><li>99</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pops</span><span class="p">[[</span><span class="m">2</span><span class="p">]]</span><span class="o">$</span><span class="n">lat</span> <span class="c1">#latitude of second species</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">56</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pops</span><span class="p">[[</span><span class="m">3</span><span class="p">]]</span><span class="o">$</span><span class="n">pop</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="o">&lt;-</span><span class="m">102</span> <span class="c1">#change population of third species at third time step</span>
<span class="n">pops</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><dl>
	<dt>$sp1</dt>
		<dd><dl>
	<dt>$lat</dt>
		<dd>19</dd>
	<dt>$long</dt>
		<dd>57</dd>
	<dt>$pop</dt>
		<dd><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>100</li><li>101</li><li>99</li></ol>
</dd>
</dl>
</dd>
	<dt>$sp2</dt>
		<dd><dl>
	<dt>$lat</dt>
		<dd>56</dd>
	<dt>$long</dt>
		<dd>-120</dd>
	<dt>$pop</dt>
		<dd><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1</li><li>4</li><li>7</li><li>7</li><li>2</li><li>1</li><li>2</li></ol>
</dd>
</dl>
</dd>
	<dt>$sp3</dt>
		<dd><dl>
	<dt>$lat</dt>
		<dd>32</dd>
	<dt>$long</dt>
		<dd>-10</dd>
	<dt>$pop</dt>
		<dd><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>12</li><li>11</li><li>102</li><li>1</li><li>14</li></ol>
</dd>
</dl>
</dd>
</dl>
</div></div>
</div>
<p>Maybe you have guessed by now that R dataframes are actually a kind of list.</p>
</section>
<section id="matrix-vs-dataframe">
<h3>Matrix vs Dataframe<a class="headerlink" href="#matrix-vs-dataframe" title="Permalink to this headline">#</a></h3>
<p>If dataframes are so nice, why use R matrices at all? The problem is that dataframes can be too slow when large numbers of mathematical calculations or operations (e.g., matrix - vector multiplications or other linear algebra operations) need to be performed. In such cases, you will need to convert a dataframe to a matrix. But for statistical analyses, plotting, and writing output of standard R analyses to a file, data frames are more convenient. Dataframes also allow you to refer to columns by name (using <code class="docutils literal notranslate"><span class="pre">$</span></code>), which is often convenient.</p>
<p>To see the difference in memory usage of matrices vs dataframes, try this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyMat</span> <span class="o">=</span> <span class="nf">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">8</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span>
<span class="n">MyMat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A matrix: 4 × 4 of type int</caption>
<tbody>
	<tr><td>1</td><td>5</td><td>1</td><td>5</td></tr>
	<tr><td>2</td><td>6</td><td>2</td><td>6</td></tr>
	<tr><td>3</td><td>7</td><td>3</td><td>7</td></tr>
	<tr><td>4</td><td>8</td><td>4</td><td>8</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyDF</span> <span class="o">=</span> <span class="nf">as.data.frame</span><span class="p">(</span><span class="n">MyMat</span><span class="p">)</span>
<span class="n">MyDF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 4 × 4</caption>
<thead>
	<tr><th scope=col>V1</th><th scope=col>V2</th><th scope=col>V3</th><th scope=col>V4</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1</td><td>5</td><td>1</td><td>5</td></tr>
	<tr><td>2</td><td>6</td><td>2</td><td>6</td></tr>
	<tr><td>3</td><td>7</td><td>3</td><td>7</td></tr>
	<tr><td>4</td><td>8</td><td>4</td><td>8</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">object.size</span><span class="p">(</span><span class="n">MyMat</span><span class="p">)</span> <span class="c1"># returns size of an R object (variable) in bytes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>280 bytes
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">object.size</span><span class="p">(</span><span class="n">MyDF</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1152 bytes
</pre></div>
</div>
</div>
</div>
<p>Quite a big difference!</p>
</section>
</section>
<section id="creating-and-manipulating-data">
<h2>Creating and manipulating data<a class="headerlink" href="#creating-and-manipulating-data" title="Permalink to this headline">#</a></h2>
<section id="creating-sequences">
<span id="r-creating-sequences"></span><h3>Creating sequences<a class="headerlink" href="#creating-sequences" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">:</span></code> operator creates vectors of sequential integers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">years</span> <span class="o">&lt;-</span> <span class="m">1990</span><span class="o">:</span><span class="m">2009</span>
<span class="n">years</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1990</li><li>1991</li><li>1992</li><li>1993</li><li>1994</li><li>1995</li><li>1996</li><li>1997</li><li>1998</li><li>1999</li><li>2000</li><li>2001</li><li>2002</li><li>2003</li><li>2004</li><li>2005</li><li>2006</li><li>2007</li><li>2008</li><li>2009</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">years</span> <span class="o">&lt;-</span> <span class="m">2009</span><span class="o">:</span><span class="m">1990</span> <span class="c1"># or in reverse order </span>
<span class="n">years</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>2009</li><li>2008</li><li>2007</li><li>2006</li><li>2005</li><li>2004</li><li>2003</li><li>2002</li><li>2001</li><li>2000</li><li>1999</li><li>1998</li><li>1997</li><li>1996</li><li>1995</li><li>1994</li><li>1993</li><li>1992</li><li>1991</li><li>1990</li></ol>
</div></div>
</div>
<p>For sequences of float numbers, you have to use <code class="docutils literal notranslate"><span class="pre">seq()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1</li><li>1.5</li><li>2</li><li>2.5</li><li>3</li><li>3.5</li><li>4</li><li>4.5</li><li>5</li><li>5.5</li><li>6</li><li>6.5</li><li>7</li><li>7.5</li><li>8</li><li>8.5</li><li>9</li><li>9.5</li><li>10</li></ol>
</div></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Don’t forget, you can get help on a particular R command by prefixing it with <code class="docutils literal notranslate"><span class="pre">?</span></code>. For example, try:</p>
<p><code class="docutils literal notranslate"><span class="pre">?seq</span></code></p>
</div>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">seq(from=1,to=10,</span> <span class="pre">by=0.5)</span> </code>OR<code class="docutils literal notranslate"> <span class="pre">seq(from=1,</span> <span class="pre">by=0.5,</span> <span class="pre">to=10)</span></code> with the same effect (try it). This explicit, “argument matching” approach is partly what makes R so popular and accessible to a wider range of users.</p>
</section>
<section id="accessing-parts-of-data-stuctures-indices-and-indexing">
<span id="r-indices"></span><h3>Accessing parts of data stuctures: Indices and Indexing<a class="headerlink" href="#accessing-parts-of-data-stuctures-indices-and-indexing" title="Permalink to this headline">#</a></h3>
<p>Every element (entry) of a vector in R has an order (an “index” value): the first value, second, third, etc. To illustrate this, let’s create a simple vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyVar</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span> <span class="s">&#39;a&#39;</span> <span class="p">,</span> <span class="s">&#39;b&#39;</span> <span class="p">,</span> <span class="s">&#39;c&#39;</span> <span class="p">,</span> <span class="s">&#39;d&#39;</span> <span class="p">,</span> <span class="s">&#39;e&#39;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then, square brackets extract values based on their numerical order in the vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyVar</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="c1"># Show element in first position </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'a'</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyVar</span><span class="p">[</span><span class="m">4</span><span class="p">]</span> <span class="c1"># Show element in fourth position </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'d'</div></div>
</div>
<p>The values in square brackets are called “indices” — they give the index (position) of the required value. We can also select sets of values in different orders, or repeat values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyVar</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">)]</span> <span class="c1"># reverse order</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'c'</li><li>'b'</li><li>'a'</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyVar</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">5</span><span class="p">)]</span> <span class="c1"># repeat indices</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'a'</li><li>'a'</li><li>'e'</li><li>'e'</li></ol>
</div></div>
</div>
<p>You can also manipulate data structures/objects by indexing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span> <span class="c1"># Create a vector named v</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="p">[</span><span class="m">3</span><span class="p">]</span> <span class="c1"># access one element</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">2</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">]</span> <span class="c1"># access sequential elements</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0</li><li>1</li><li>2</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="p">[</span><span class="m">-3</span><span class="p">]</span> <span class="c1"># remove elements</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0</li><li>1</li><li>3</li><li>4</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">4</span><span class="p">)]</span> <span class="c1"># access non-sequential indices</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0</li><li>3</li></ol>
</div></div>
</div>
<p>For matrices, you need to use both row and column indices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mat1</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">25</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="n">byrow</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span> <span class="c1">#create a matrix</span>
<span class="n">mat1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A matrix: 5 × 5 of type int</caption>
<tbody>
	<tr><td> 1</td><td> 2</td><td> 3</td><td> 4</td><td> 5</td></tr>
	<tr><td> 6</td><td> 7</td><td> 8</td><td> 9</td><td>10</td></tr>
	<tr><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td></tr>
	<tr><td>16</td><td>17</td><td>18</td><td>19</td><td>20</td></tr>
	<tr><td>21</td><td>22</td><td>23</td><td>24</td><td>25</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mat1</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">2</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mat1</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="o">:</span><span class="m">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>2</li><li>3</li><li>4</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mat1</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="o">:</span><span class="m">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A matrix: 2 × 3 of type int</caption>
<tbody>
	<tr><td>2</td><td>3</td><td>4</td></tr>
	<tr><td>7</td><td>8</td><td>9</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>And to get all elements in a particular row or column, you need to leave the value blank:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mat1</span><span class="p">[</span><span class="m">1</span><span class="p">,]</span> <span class="c1"># First row, all columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mat1</span><span class="p">[,</span><span class="m">1</span><span class="p">]</span> <span class="c1"># First column, all rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1</li><li>6</li><li>11</li><li>16</li><li>21</li></ol>
</div></div>
</div>
</section>
<section id="recycling">
<span id="r-recycling"></span><h3>Recycling<a class="headerlink" href="#recycling" title="Permalink to this headline">#</a></h3>
<p>When vectors are of different lengths, R will recycle the shorter one to make a vector of the same length:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span> <span class="m">2</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>3</li><li>7</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">);</span> <span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">9</span><span class="p">,</span><span class="m">2</span><span class="p">)</span>
<span class="n">x</span><span class="p">;</span><span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1</li><li>2</li></ol>
</div><div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>5</li><li>3</li><li>9</li><li>2</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>6</li><li>5</li><li>10</li><li>4</li></ol>
</div></div>
</div>
<p>Strange! R just recycled <code class="docutils literal notranslate"><span class="pre">x</span></code> (repeated <code class="docutils literal notranslate"><span class="pre">1,2</span></code> twice) so that the two vectors could be summed! here’s another example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">+</span> <span class="nf">c</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in x + c(y, 1):
“longer object length is not a multiple of shorter object length”
</pre></div>
</div>
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>6</li><li>5</li><li>10</li><li>4</li><li>2</li></ol>
</div></div>
</div>
<p><em>Think about what happened here</em>. R is clearly not comfortable doing this, so it warns you! Recycling could be convenient at times, but is dangerous!</p>
</section>
<section id="basic-vector-matrix-operations">
<h3>Basic vector-matrix operations<a class="headerlink" href="#basic-vector-matrix-operations" title="Permalink to this headline">#</a></h3>
<p>You can perform the usual vector matrix operations on R <code class="docutils literal notranslate"><span class="pre">vectors</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span>
<span class="n">v2</span> <span class="o">&lt;-</span> <span class="n">v</span><span class="o">*</span><span class="m">2</span> <span class="c1"># multiply whole vector by 2</span>
<span class="n">v2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0</li><li>2</li><li>4</li><li>6</li><li>8</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">*</span> <span class="n">v2</span> <span class="c1"># element-wise product</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0</li><li>2</li><li>8</li><li>18</li><li>32</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">t</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="c1"># transpose the vector</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A matrix: 1 × 5 of type dbl</caption>
<tbody>
	<tr><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">%*%</span> <span class="nf">t</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="c1"># matrix/vector product</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A matrix: 5 × 5 of type dbl</caption>
<tbody>
	<tr><td>0</td><td>0</td><td>0</td><td> 0</td><td> 0</td></tr>
	<tr><td>0</td><td>1</td><td>2</td><td> 3</td><td> 4</td></tr>
	<tr><td>0</td><td>2</td><td>4</td><td> 6</td><td> 8</td></tr>
	<tr><td>0</td><td>3</td><td>6</td><td> 9</td><td>12</td></tr>
	<tr><td>0</td><td>4</td><td>8</td><td>12</td><td>16</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v3</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="m">7</span> <span class="c1"># assign using sequence</span>
<span class="n">v3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v4</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">)</span> <span class="c1"># concatenate vectors</span>
<span class="n">v4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0</li><li>2</li><li>4</li><li>6</li><li>8</li><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li></ol>
</div></div>
</div>
</section>
<section id="strings-and-pasting">
<h3>Strings and Pasting<a class="headerlink" href="#strings-and-pasting" title="Permalink to this headline">#</a></h3>
<p>It is important to know how to handle strings in R for two main reasons:</p>
<ul class="simple">
<li><p>To deal with text data, such as names of experimental treatments</p></li>
<li><p>To generate appropriate text labels and titles for figures</p></li>
</ul>
<p>Let’s try creating and manipulating strings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">species.name</span> <span class="o">&lt;-</span> <span class="s">&quot;Quercus robur&quot;</span> <span class="c1">#You can alo use single quotes</span>
<span class="n">species.name</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'Quercus robur'</div></div>
</div>
<p>To combine to strings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Quercus&quot;</span><span class="p">,</span> <span class="s">&quot;robur&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'Quercus robur'</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Quercus&quot;</span><span class="p">,</span> <span class="s">&quot;robur&quot;</span><span class="p">,</span><span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="c1">#Get rid of space</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'Quercusrobur'</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Quercus&quot;</span><span class="p">,</span> <span class="s">&quot;robur&quot;</span><span class="p">,</span><span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;, &quot;</span><span class="p">)</span> <span class="c1">#insert comma to separate</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'Quercus, robur'</div></div>
</div>
<p>As you can see above, both double and single quotes work, but using double quotes is better because it will allow you to define strings that contain a single quotes, which is often necessary.</p>
<p>And as is the case with so many R functions, pasting works on vectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">paste</span><span class="p">(</span><span class="s">&#39;Year is:&#39;</span><span class="p">,</span> <span class="m">1990</span><span class="o">:</span><span class="m">2000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'Year is: 1990'</li><li>'Year is: 1991'</li><li>'Year is: 1992'</li><li>'Year is: 1993'</li><li>'Year is: 1994'</li><li>'Year is: 1995'</li><li>'Year is: 1996'</li><li>'Year is: 1997'</li><li>'Year is: 1998'</li><li>'Year is: 1999'</li><li>'Year is: 2000'</li></ol>
</div></div>
</div>
<p>Note that this last example creates a vector of 11 strings as it is 1990:2000 <em>inclusive</em>.</p>
</section>
</section>
<section id="useful-r-functions">
<h2>Useful R functions<a class="headerlink" href="#useful-r-functions" title="Permalink to this headline">#</a></h2>
<p>There are a number of very useful functions available by default (in the “base packages”). Some particularly useful ones are listed below.</p>
<section id="for-manipulating-strings">
<h3>For manipulating strings<a class="headerlink" href="#for-manipulating-strings" title="Permalink to this headline">#</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Function</p></th>
<th class="text-align:left head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">strsplit(x,';')</span></code></p></td>
<td class="text-align:left"><p>Split the string <code class="docutils literal notranslate"><span class="pre">x</span></code> at ‘;’</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">nchar(x)</span></code></p></td>
<td class="text-align:left"><p>Number of characters in string <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">toupper(x)</span></code></p></td>
<td class="text-align:left"><p>Set string <code class="docutils literal notranslate"><span class="pre">x</span></code> to upper case</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">tolower(x)</span></code></p></td>
<td class="text-align:left"><p>Set string <code class="docutils literal notranslate"><span class="pre">x</span></code> to lower case</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">paste(x1,x2,sep=';')</span></code></p></td>
<td class="text-align:left"><p>Join the two strings using ‘;’</p></td>
</tr>
</tbody>
</table>
</section>
<section id="mathematical">
<h3>Mathematical<a class="headerlink" href="#mathematical" title="Permalink to this headline">#</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Function</p></th>
<th class="text-align:left head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">log(x)</span></code></p></td>
<td class="text-align:left"><p>Natural logarithm of the number (or every number in the vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">log10(x)</span></code></p></td>
<td class="text-align:left"><p>Logarithm in base 10 of the number (or every number in the vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">exp(x)</span></code></p></td>
<td class="text-align:left"><p>Exponential of the number (or every number in the vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code> (<span class="math notranslate nohighlight">\(e^x\)</span>)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">abs(x)</span></code></p></td>
<td class="text-align:left"><p>Absolute value of the number (or every number in the vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">floor(x)</span></code></p></td>
<td class="text-align:left"><p>Largest integer smaller than the number (or every number in the vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">ceiling(x)</span></code></p></td>
<td class="text-align:left"><p>Smallest integer greater than the number (or every number in the vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">sqrt(x)</span></code></p></td>
<td class="text-align:left"><p>Square root of the number (or every number in the vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code> (<span class="math notranslate nohighlight">\(\sqrt{x}\)</span>)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">sin(x)</span></code></p></td>
<td class="text-align:left"><p>Sine function of the number (or every number in a vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">pi</span></code></p></td>
<td class="text-align:left"><p>Value of the constant <span class="math notranslate nohighlight">\(\pi\)</span></p></td>
</tr>
</tbody>
</table>
</section>
<section id="statistical">
<h3>Statistical<a class="headerlink" href="#statistical" title="Permalink to this headline">#</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Function</p></th>
<th class="text-align:left head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">mean(x)</span></code></p></td>
<td class="text-align:left"><p>Compute mean of (a vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">sd(x)</span></code></p></td>
<td class="text-align:left"><p>Standard deviation of (a vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">var(x)</span></code></p></td>
<td class="text-align:left"><p>Variance of (a vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">median(x)</span></code></p></td>
<td class="text-align:left"><p>Median of (a vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">quantile(x,0.05)</span></code></p></td>
<td class="text-align:left"><p>Compute the 0.05 quantile of (a vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">range(x)</span></code></p></td>
<td class="text-align:left"><p>Range of the data in (a vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">min(x)</span></code></p></td>
<td class="text-align:left"><p>Minimum of (a vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">max(x)</span></code></p></td>
<td class="text-align:left"><p>Maximum of (a vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">sum(x)</span></code></p></td>
<td class="text-align:left"><p>Sum all elements of (a vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">summary(x)</span></code></p></td>
<td class="text-align:left"><p>Summary statistics for (a vector or matrix) <code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="sets">
<h3>Sets<a class="headerlink" href="#sets" title="Permalink to this headline">#</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Function</p></th>
<th class="text-align:left head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">union(x,</span> <span class="pre">y)</span></code></p></td>
<td class="text-align:left"><p>Union of all elements of two vectors x &amp; y</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">intersect(x,</span> <span class="pre">y)</span></code></p></td>
<td class="text-align:left"><p>Elements common to two vectors x &amp; y</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">setdiff(x,</span> <span class="pre">y)</span></code></p></td>
<td class="text-align:left"><p>Elements unique to two vectors x &amp; y</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">setequal(x,</span> <span class="pre">y)</span></code></p></td>
<td class="text-align:left"><p>Check if two vectors x &amp; y are the same set (have same unique elements)</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">is.element(x,</span> <span class="pre">y)</span></code></p></td>
<td class="text-align:left"><p>Check if an element x is in vector y (same as <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">%in%</span> <span class="pre">y</span></code>)</p></td>
</tr>
</tbody>
</table>
<p>★ <em>Try out the above commands in your R console by generating the appropriate data</em>. For example,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">strsplit</span><span class="p">(</span><span class="s">&quot;String; to; Split&quot;</span><span class="p">,</span><span class="s">&#39;;&#39;</span><span class="p">)</span><span class="c1"># Split the string at &#39;;&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><ol>
	<li><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'String'</li><li>' to'</li><li>' Split'</li></ol>
</li>
</ol>
</div></div>
</div>
</section>
<section id="generating-random-numbers">
<span id="r-random-numbers"></span><h3>Generating Random Numbers<a class="headerlink" href="#generating-random-numbers" title="Permalink to this headline">#</a></h3>
<p>You will probably need to generate random numbers at some point as a quantitative biologist.</p>
<p>R has many routines for generating random samples from various probability distributions. There are a number of random number distributions that you can sample or generate random numbers from:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Function</p></th>
<th class="text-align:left head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">rnorm(10,</span> <span class="pre">m=0,</span> <span class="pre">sd=1)</span></code></p></td>
<td class="text-align:left"><p>Draw 10 normal random numbers with mean=0 and standard deviation = 1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">dnorm(x,</span> <span class="pre">m=0,</span> <span class="pre">sd=1)</span></code></p></td>
<td class="text-align:left"><p>Density function</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">qnorm(x,</span> <span class="pre">m=0,</span> <span class="pre">sd=1)</span></code></p></td>
<td class="text-align:left"><p>Cumulative density function</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">runif(20,</span> <span class="pre">min=0,</span> <span class="pre">max=2)</span></code></p></td>
<td class="text-align:left"><p>Twenty random numbers from uniform <code class="docutils literal notranslate"><span class="pre">[0,2]</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"> <span class="pre">rpois(20,</span> <span class="pre">lambda=10)</span></code></p></td>
<td class="text-align:left"><p>Twenty random numbers from Poisson (with mean <span class="math notranslate nohighlight">\(\lambda\)</span>)</p></td>
</tr>
</tbody>
</table>
<section id="seeding-random-number-generators">
<h4>“Seeding” random number generators<a class="headerlink" href="#seeding-random-number-generators" title="Permalink to this headline">#</a></h4>
<p>Computers <em>can’t</em> generate <em>true</em> mathematically random numbers. This may seem surprising, but basically a computer cannot be programmed to do things purely by chance; it can only follow given instructions blindly and is therefore completely predictable. Instead, computers have algorithms called “pseudo-random number generators” that generate <em>practically random</em> sequences of numbers. These are typically based on a iterative formula that generates a sequence of random numbers, starting with a first number called the “<strong>seed</strong>”. This sequence is completely “deterministic”, that is, starting with a particular seed yields exactly the same sequence of pseudo-random numbers every time you re-run the generator.</p>
<p>Try this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">1234567</span><span class="p">)</span>
<span class="nf">rnorm</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.156703769128359</div></div>
</div>
<p>Everybody in the class  will get the same answer!</p>
<p>Now try and compare the results with your neighbor:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">rnorm</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1.37381119149164</li><li>0.73067024376365</li><li>-1.35080092669852</li><li>-0.00851496085595985</li><li>0.320981862836429</li><li>-1.77814840855737</li><li>0.909503835073888</li><li>-0.919404336160487</li><li>-0.157714830888067</li><li>1.10199738945752</li></ol>
</div></div>
</div>
<p>And then the whole sequence of 11 numbers you generated:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">1234567</span><span class="p">)</span>
<span class="nf">rnorm</span><span class="p">(</span><span class="m">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0.156703769128359</li><li>1.37381119149164</li><li>0.73067024376365</li><li>-1.35080092669852</li><li>-0.00851496085595985</li><li>0.320981862836429</li><li>-1.77814840855737</li><li>0.909503835073888</li><li>-0.919404336160487</li><li>-0.157714830888067</li><li>1.10199738945752</li></ol>
</div></div>
</div>
<p>Thus, setting the seed allows you to reliably generate the identical sequence of “random” numbers. These numbers are not truly random, but have the properties of random numbers. Note also that pseudo-random number generators are periodic, which means that the sequence will eventually repeat itself. However, this  period is so long that it can be ignored for most practical purposes. So effectively, <code class="docutils literal notranslate"><span class="pre">rnorm</span></code> has an enormous list that it cycles through. The random seed starts the process, i.e., indicates where in the list to start. This is usually taken from the clock when you start R.</p>
<p>But why bother with random number seeds? Setting a particular seed can be useful when debugging programs (coming up below). Bugs in code can be hard to find — harder still if you are generating random numbers, so repeat runs of your code may or may not all trigger the same behavior. You can set the seed once at the beginning of the code — ensuring repeatability, retaining (pseudo) randomness. Once  debugged, if you want, you can remove the set seed line.</p>
</section>
</section>
</section>
<section id="your-analysis-workflow">
<h2>Your analysis workflow<a class="headerlink" href="#your-analysis-workflow" title="Permalink to this headline">#</a></h2>
<p>In using R for an analysis, you will likely use and create several files. As in the case of bash and Python based projects, in R projects as well, you should keep your workflow well organized. For example, it is sensible to create a folder (directory) to keep all code files together. You can then set R to work from this directory, so that files are easy to find and run — this will be your “working directory” (more on this below). Also, you don’t want to mix code files with data and results files. So you should create separate directories for these as well.</p>
<p>Thus, your typical R analysis workflow will be:</p>
<hr class="docutils" />
<figure class="align-default" id="r-project-org">
<a class="reference internal image-reference" href="../_images/RWorkflow.png"><img alt="R Project Organization" src="../_images/RWorkflow.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text"><strong>Your R project.</strong> Keeping it neat and organized if the key to becoming a good R programmer.</span><a class="headerlink" href="#r-project-org" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<hr class="docutils" />
<p>Some details on each kind of file:</p>
<ul class="simple">
<li><p><em>R script files</em>: These are plain text files containing all the R code needed for an analysis. These should  be created with a text editor, typically part of some smart code editor like vscode, or RStudio, and saved with the extension <code class="docutils literal notranslate"><span class="pre">*.R</span></code>. You should <em>never</em> use Word to save or edit these files as R can only read code from plain text files.</p></li>
<li><p><em>Text data files</em> These are files of data in plain text format containing one or more columns of data (numbers, strings, or both). Although there are several format options, we will typically be using <code class="docutils literal notranslate"><span class="pre">csv</span></code> files, where the data entries are separated by commas. These are easy to create and export from Excel (if that’s what you use…).</p></li>
<li><p><em>Results output files</em> These are a plain text files containing your results, such the the summary of output of a regression or ANOVA analysis. Typically, you will output your results in a table format where the columns are separated by commas (csv) or tabs (tab-delimited).</p></li>
<li><p><em>Graphics files</em> R can export graphics in a wide range of formats. This can be done automatically from R code and we will look at this later but you can also select a graphics window (e.g., in RStudio) and click <code class="docutils literal notranslate"><span class="pre">File</span></code> <span class="math notranslate nohighlight">\(\triangleright\)</span> <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">as...</span></code>.</p></li>
<li><p><em>Rdata files</em> You can save any data loaded or created in R, including outputs of statistical analyses and other things, into a single<code class="docutils literal notranslate"><span class="pre">Rdata</span></code> file. These are not plain text and can only be read by R, but can hold all the data from an analysis in a single handy location. We will not use these much in this course.</p></li>
</ul>
<p>So let’s build your R analysis project structure.</p>
<p>Do the following:</p>
<p>★ Create a sensibly-named directory (e.g., <code class="docutils literal notranslate"><span class="pre">MyRCoursework</span></code>, <code class="docutils literal notranslate"><span class="pre">week3</span></code>, etc, depnding on which course you are on) in an appropriate location on your computer. If you are using a college Windows computer, you may need to create it in your <code class="docutils literal notranslate"><span class="pre">H:</span></code> drive. Avoid including spaces in your file or directory names, as this will often create problems when you share your file or directory with somebody else. Many software programs do not handle spaces in file/directory names well. Use underscores instead of spaces. For example, instead of <code class="docutils literal notranslate"><span class="pre">My</span> <span class="pre">R</span> <span class="pre">Coursework</span></code>, use <code class="docutils literal notranslate"><span class="pre">My_R_Coursework</span></code> or <code class="docutils literal notranslate"><span class="pre">MyRCoursework</span></code>.</p>
<p>★ Create subdirectories <em>within this directory</em> called <code class="docutils literal notranslate"><span class="pre">code</span></code>, <code class="docutils literal notranslate"><span class="pre">data</span></code>, and <code class="docutils literal notranslate"><span class="pre">results</span></code>. Remember,  commands in all programming languages are case-sensitive when it comes to reading directory path names, so <code class="docutils literal notranslate"><span class="pre">code</span></code> is not the same as <code class="docutils literal notranslate"><span class="pre">Code</span></code>!</p>
<p>You can create directories using <code class="docutils literal notranslate"><span class="pre">dir.create()</span></code>within R (or if on Mac/Linux, with the usual <code class="docutils literal notranslate"><span class="pre">mkdir</span></code> from the bash terminal):</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">dir.create</span><span class="p">(</span><span class="s">&quot;MyRCoursework&quot;</span><span class="p">)</span>
<span class="nf">dir.create</span><span class="p">(</span><span class="s">&quot;MyRCoursework/code&quot;</span><span class="p">)</span>
<span class="nf">dir.create</span><span class="p">(</span><span class="s">&quot;MyRCoursework/data&quot;</span><span class="p">)</span>    
<span class="nf">dir.create</span><span class="p">(</span><span class="s">&quot;MyRCoursework/results&quot;</span><span class="p">)</span>    
</pre></div>
</div>
<section id="the-r-workspace-and-working-directory">
<h3>The R Workspace and Working Directory<a class="headerlink" href="#the-r-workspace-and-working-directory" title="Permalink to this headline">#</a></h3>
<p>R has a “workspace” – a current working environment that includes any user-defined data structures objects (vectors, matrices, data frames, lists) as well as other objects (e.g., functions). At the end of an R session, the user can save an image of the current workspace that is automatically reloaded the next time R is started. Your workspace is saved in your “Working Directory”, which has to be set manually.</p>
<p>So before we go any further, let’s get sort out where your R “Working Directory” should be and how you should set it. R has a default location where it assumes your working directory is.</p>
<ul class="simple">
<li><p>In UNIX/Linux, it is whichever directory you are in when you launch R.</p></li>
<li><p>In Mac, it is <code class="docutils literal notranslate"><span class="pre">/User/YourUserName</span></code> or similar.</p></li>
<li><p>In Windows, it is <code class="docutils literal notranslate"><span class="pre">C:/Windows/system32</span></code>or similar.</p></li>
</ul>
<p>To see where your current working directory is, at the R command prompt, type:</p>
<p><code class="docutils literal notranslate"><span class="pre">getwd()</span></code></p>
<p>This tells you what the current <code class="docutils literal notranslate"><span class="pre">w</span></code>orking <code class="docutils literal notranslate"><span class="pre">d</span></code>irectory is.</p>
<p>Now, set the working directory to be <code class="docutils literal notranslate"><span class="pre">MrRCourseworkcode</span></code>. For example, if you created <code class="docutils literal notranslate"><span class="pre">MrRCoursework</span></code>directly in your <code class="docutils literal notranslate"><span class="pre">H:\</span></code>, the you would use:</p>
<p><code class="docutils literal notranslate"><span class="pre">setwd(&quot;H:/MrRCourseworkcode&quot;)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">dir()</span></code> #check what’s in the current working directory</p>
<p>On your own computer, you can also change R’s default to a particular working directory where you would like to start (easily done in RStudio):</p>
<ul>
<li><p>In Linux, you can do this by editing the <code class="docutils literal notranslate"><span class="pre">Rprofile.site</span></code>site with <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">gedit</span> <span class="pre">/etc/R/Rprofile.site</span></code>. In that file, you would add your start-up parameters between the lines</p>
<p><code class="docutils literal notranslate"><span class="pre">.First</span> <span class="pre">&lt;-</span> <span class="pre">function()</span> <span class="pre">cat(&quot;\n</span> <span class="pre">Welcome</span> <span class="pre">to</span> <span class="pre">R!\n\n&quot;)</span></code></p>
</li>
</ul>
<p>and</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>`.Last &lt;- function() cat(&quot;\n   Goodbye! \n\n&quot;)`.
</pre></div>
</div>
<p>Between these two lines, insert:
<code class="docutils literal notranslate"><span class="pre">setwd(&quot;/home/YourName/YourDirectoryPath&quot;)</span></code></p>
<ul class="simple">
<li><p>In Windows and Macs, you can find the <code class="docutils literal notranslate"><span class="pre">Rprofile.site</span></code>file by searching for it. On Windows, it should be at <code class="docutils literal notranslate"><span class="pre">C:\Program</span> <span class="pre">Files\R\R-x.x.x\etc</span></code> directory, where <code class="docutils literal notranslate"><span class="pre">x.x.x</span></code> is your R version.</p></li>
<li><p>If you are using RStudio, you can change the default working directory through the RStudio “Options” dialog.</p></li>
</ul>
</section>
</section>
<section id="importing-and-exporting-data">
<h2>Importing and Exporting Data<a class="headerlink" href="#importing-and-exporting-data" title="Permalink to this headline">#</a></h2>
<p>We are now ready to see how to import and export data in R, typically the first step of your analysis. The best option is to have your data in a <code class="docutils literal notranslate"><span class="pre">c</span></code>omma <code class="docutils literal notranslate"><span class="pre">s</span></code>eparated <code class="docutils literal notranslate"><span class="pre">v</span></code>alue (<code class="docutils literal notranslate"> <span class="pre">csv</span></code>) text file or in a tab separated text file. Then, you can use the function <code class="docutils literal notranslate"><span class="pre">read.csv</span></code>(or <code class="docutils literal notranslate"><span class="pre">read.table</span></code>) to import your data. Now, lets get some data into your <code class="docutils literal notranslate"><span class="pre">Data</span></code>directory.</p>
<p>★ Go to the <a class="reference external" href="https://github.com/mhasoba/TheMulQuaBio">TheMulQuaBio git repository</a> and navigate to the <a class="reference external" href="https://github.com/mhasoba/TheMulQuaBio/tree/master/content/data"><code class="docutils literal notranslate"><span class="pre">data</span></code> directory</a>.</p>
<p>★ Download and copy the file <a class="reference external" href="https://raw.githubusercontent.com/mhasoba/TheMulQuaBio/master/content/data/trees.csv"><code class="docutils literal notranslate"><span class="pre">trees.csv</span></code></a> into your own <code class="docutils literal notranslate"><span class="pre">data</span></code> directory.</p>
<p>Alternatively, of you may download the whole repository to your computer and then grab the file from the place where you downloaded it.</p>
<p>Now, import the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyData</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;../data/trees.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ls</span><span class="p">(</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&quot;My*&quot;</span><span class="p">)</span> <span class="c1"># Check that MyData has appeared</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'MyData'</li><li>'MyDF'</li><li>'MyList'</li><li>'MyMat'</li><li>'MyVar'</li></ol>
</div></div>
</div>
<p>Your output may be somewhat different, depending on what what variables and other objects have been created in
your R Workspace during the current R session. But the main thing is, you should be able to see a <code class="docutils literal notranslate"><span class="pre">MyData</span></code> in the list of objects printed.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can list only objects with a particular name pattern by using the <code class="docutils literal notranslate"><span class="pre">pattern</span></code> option of <code class="docutils literal notranslate"><span class="pre">ls()</span></code>. It works by using regular expressions, which you were introduced through the <code class="docutils literal notranslate"><span class="pre">grep</span></code> command in the <a class="reference internal" href="01-Unix.html#using-grep"><span class="std std-ref">UNIX chapter</span></a>. We will delve deeper into regular expressions in the <a class="reference internal" href="06-Python_II.html#python-ii-python-regex"><span class="std std-ref">Python II Chapter</span></a>.</p>
</div>
<p>Note that the resulting <code class="docutils literal notranslate"><span class="pre">MyData</span></code> object in your workspace is a R dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">class</span><span class="p">(</span><span class="n">MyData</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'data.frame'</div></div>
</div>
<section id="relative-paths">
<h3>Relative paths<a class="headerlink" href="#relative-paths" title="Permalink to this headline">#</a></h3>
<p>Note the UNIX-like path to the file we used in the <code class="docutils literal notranslate"><span class="pre">read.csv()</span></code> command above (using forward slashes; Windows uses back slashes).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">../</span></code> in <code class="docutils literal notranslate"><span class="pre">read.csv(&quot;../data/trees.csv&quot;)</span></code> above signifies a “relative” path. That is, you are asking R to load data that lies in a different directory (folder) <em>relative</em> your current location (in this case, you are in your <code class="docutils literal notranslate"><span class="pre">Code</span></code>directory). In other, more technical words, <code class="docutils literal notranslate"><span class="pre">../data/trees.txt</span></code>points to a file named <code class="docutils literal notranslate"><span class="pre">trees.txt</span></code>located in the “parent” of the current directory.</p>
<p><em>What is an absolute path?</em> — one that specifies the whole path on your computer, say from <code class="docutils literal notranslate"><span class="pre">C:\</span></code>”upwards” on Windows, <code class="docutils literal notranslate"><span class="pre">/Users/</span></code> upwards on Mac, and <code class="docutils literal notranslate"><span class="pre">/home/</span></code> upwards on Linux. Absolute paths are specific to each computer, so should be avoided. So to import data and export results, your script should <em>not</em> use absolute paths. Also, <em>AVOID putting a <code class="docutils literal notranslate"><span class="pre">setwd()</span></code>command at the start of your R script</em>, because setting the working directory requires an absolute directory path, which will differ across computers, platforms, and users. Let the end users set the working directory on their machine themselves.</p>
<p>Using relative paths in in your R scripts and code will make your code computer-independent and easier for others to use your code. The relative path way should always be the way you load data in your analyses scripts — it will guarantee that your analysis works on every computer, not just your own or college computer.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you are using a computer from elsewhere in the EU, Excel may use a comma (e.g., <span class="math notranslate nohighlight">\(\pi=3,1416\)</span>) instead of a decimal point (<span class="math notranslate nohighlight">\(\pi=3.1416\)</span>). In this case, <code class="docutils literal notranslate"><span class="pre">csv</span></code>files may use a semi-colon to separate columns and you can use the alternative function <code class="docutils literal notranslate"><span class="pre">read.csv2()</span></code> to read them into the R workspace.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">head</span><span class="p">(</span><span class="n">MyData</span><span class="p">)</span> <span class="c1"># Have a quick look at the data frame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 3</caption>
<thead>
	<tr><th></th><th scope=col>Species</th><th scope=col>Distance.m</th><th scope=col>Angle.degrees</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>Populus tremula   </td><td>31.66583</td><td>41.28264</td></tr>
	<tr><th scope=row>2</th><td>Quercus robur     </td><td>45.98499</td><td>44.53592</td></tr>
	<tr><th scope=row>3</th><td>Ginkgo biloba     </td><td>31.24177</td><td>25.14626</td></tr>
	<tr><th scope=row>4</th><td>Fraxinus excelsior</td><td>34.61667</td><td>23.33613</td></tr>
	<tr><th scope=row>5</th><td>Betula pendula    </td><td>45.46617</td><td>38.34913</td></tr>
	<tr><th scope=row>6</th><td>Betula pendula    </td><td>48.79550</td><td>33.59231</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>You can also have a more detailed look at the data you imported:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">str</span><span class="p">(</span><span class="n">MyData</span><span class="p">)</span> <span class="c1"># Note the data types of the three columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;data.frame&#39;:	120 obs. of  3 variables:
 $ Species      : chr  &quot;Populus tremula&quot; &quot;Quercus robur&quot; &quot;Ginkgo biloba&quot; &quot;Fraxinus excelsior&quot; ...
 $ Distance.m   : num  31.7 46 31.2 34.6 45.5 ...
 $ Angle.degrees: num  41.3 44.5 25.1 23.3 38.3 ...
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyData</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;../data/trees.csv&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="bp">F</span><span class="p">)</span> <span class="c1"># Import ignoring headers</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">head</span><span class="p">(</span><span class="n">MyData</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 3</caption>
<thead>
	<tr><th></th><th scope=col>V1</th><th scope=col>V2</th><th scope=col>V3</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>Species           </td><td>Distance.m      </td><td>Angle.degrees   </td></tr>
	<tr><th scope=row>2</th><td>Populus tremula   </td><td>31.6658337740228</td><td>41.2826361937914</td></tr>
	<tr><th scope=row>3</th><td>Quercus robur     </td><td>45.984992608428 </td><td>44.5359166583512</td></tr>
	<tr><th scope=row>4</th><td>Ginkgo biloba     </td><td>31.2417666241527</td><td>25.1462585572153</td></tr>
	<tr><th scope=row>5</th><td>Fraxinus excelsior</td><td>34.6166691975668</td><td>23.336126555223 </td></tr>
	<tr><th scope=row>6</th><td>Betula pendula    </td><td>45.4661654261872</td><td>38.3491299510933</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Or you can load data using the more general <code class="docutils literal notranslate"><span class="pre">read.table</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyData</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&quot;../data/trees.csv&quot;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="c1">#another way</span>
</pre></div>
</div>
</div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">read.table</span></code> you need to specify whether there is a header row that needs to be imported as such.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">head</span><span class="p">(</span><span class="n">MyData</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 3</caption>
<thead>
	<tr><th></th><th scope=col>Species</th><th scope=col>Distance.m</th><th scope=col>Angle.degrees</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>Populus tremula   </td><td>31.66583</td><td>41.28264</td></tr>
	<tr><th scope=row>2</th><td>Quercus robur     </td><td>45.98499</td><td>44.53592</td></tr>
	<tr><th scope=row>3</th><td>Ginkgo biloba     </td><td>31.24177</td><td>25.14626</td></tr>
	<tr><th scope=row>4</th><td>Fraxinus excelsior</td><td>34.61667</td><td>23.33613</td></tr>
	<tr><th scope=row>5</th><td>Betula pendula    </td><td>45.46617</td><td>38.34913</td></tr>
	<tr><th scope=row>6</th><td>Betula pendula    </td><td>48.79550</td><td>33.59231</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">MyData</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;../data/trees.csv&quot;</span><span class="p">,</span> <span class="n">skip</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> <span class="c1"># skip first 5 lines</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="writing-to-and-saving-files">
<h3>Writing to and saving files<a class="headerlink" href="#writing-to-and-saving-files" title="Permalink to this headline">#</a></h3>
<p>You can also save your data frames using <code class="docutils literal notranslate"><span class="pre">write.table</span></code> or <code class="docutils literal notranslate"><span class="pre">write.csv</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">write.csv</span><span class="p">(</span><span class="n">MyData</span><span class="p">,</span> <span class="s">&quot;../results/MyData.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">dir</span><span class="p">(</span><span class="s">&quot;../results/&quot;</span><span class="p">)</span> <span class="c1"># Check if it worked</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'LV_model.pdf'</li><li>'MyData.csv'</li><li>'MyFirst-ggplot2-Figure.pdf'</li><li>'MyResults.Rout'</li><li>'Pred_Prey_Overlay.pdf'</li><li>'QMEENet.svg'</li><li>'TreeHeight.csv'</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">write.table</span><span class="p">(</span><span class="n">MyData</span><span class="p">[</span><span class="m">1</span><span class="p">,],</span> <span class="n">file</span> <span class="o">=</span> <span class="s">&quot;../results/MyData.csv&quot;</span><span class="p">,</span><span class="n">append</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># append</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in write.table(MyData[1, ], file = &quot;../results/MyData.csv&quot;, append = TRUE):
“appending column names to file”
</pre></div>
</div>
</div>
</div>
<p>You get a warning with here because R thinks it is strange that you are appending headers to a file that already has headers!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">write.csv</span><span class="p">(</span><span class="n">MyData</span><span class="p">,</span> <span class="s">&quot;../results/MyData.csv&quot;</span><span class="p">,</span> <span class="n">row.names</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># write row names</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">write.table</span><span class="p">(</span><span class="n">MyData</span><span class="p">,</span> <span class="s">&quot;../results/MyData.csv&quot;</span><span class="p">,</span> <span class="n">col.names</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span> <span class="c1"># ignore col names</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="writing-r-code">
<h2>Writing R code<a class="headerlink" href="#writing-r-code" title="Permalink to this headline">#</a></h2>
<p>Typing in commands interactively in the R console is good for starters, but you will want to switch to putting your sequence of commands into a script file, and then ask R to run those commands.</p>
<ul class="simple">
<li><p>Open a new text file, call it <code class="docutils literal notranslate"><span class="pre">basic_io.R</span></code>, and save it to your <code class="docutils literal notranslate"><span class="pre">code</span></code>directory.</p></li>
<li><p>Write the above input-output commands in it:</p></li>
</ul>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># A simple script to illustrate R input-output.  </span>
<span class="c1"># Run line by line and check inputs outputs to understand what is happening  </span>

<span class="n">MyData</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;../data/trees.csv&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># import with headers</span>

<span class="nf">write.csv</span><span class="p">(</span><span class="n">MyData</span><span class="p">,</span> <span class="s">&quot;../results/MyData.csv&quot;</span><span class="p">)</span> <span class="c1">#write it out as a new file</span>

<span class="nf">write.table</span><span class="p">(</span><span class="n">MyData</span><span class="p">[</span><span class="m">1</span><span class="p">,],</span> <span class="n">file</span> <span class="o">=</span> <span class="s">&quot;../results/MyData.csv&quot;</span><span class="p">,</span><span class="n">append</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># Append to it</span>

<span class="nf">write.csv</span><span class="p">(</span><span class="n">MyData</span><span class="p">,</span> <span class="s">&quot;../results/MyData.csv&quot;</span><span class="p">,</span> <span class="n">row.names</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># write row names</span>

<span class="nf">write.table</span><span class="p">(</span><span class="n">MyData</span><span class="p">,</span> <span class="s">&quot;../results/MyData.csv&quot;</span><span class="p">,</span> <span class="n">col.names</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span> <span class="c1"># ignore column names</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Now place the cursor on the first line of code in the script file and run it by pressing the appropriate keyboard shortcut (e.g., PC: ctrl+R, Mac: command+enter, Linux: ctrl+enter are the usual shortcuts for doing this).</p></li>
<li><p>Check after every line that you are getting the expected result.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Why no shebang in your first R script?</strong> Because we are learning R here mainly for writing scripts for data analysis &amp; visualization, and relatively simple numerical calculations &amp; modelling/simulation tasks. Read <a class="reference external" href="https://www.r-bloggers.com/2019/11/r-scripts-as-command-line-tools/">this</a> and <a class="reference external" href="https://blog.sellorm.com/2017/12/18/learn-to-write-command-line-utilities-in-r/">this</a> for some more technical advice about R scripts.</p>
</div>
</section>
<section id="running-r-code">
<h2>Running R code<a class="headerlink" href="#running-r-code" title="Permalink to this headline">#</a></h2>
<p>But even writing to a script file and running the code line-by-line or block-by-block is not your ultimate goal. What you would really like to do is to just run your full analysis and output all the results. There are two main approaches for running R script/code.</p>
<section id="using-source">
<h3>Using <code class="docutils literal notranslate"><span class="pre">source</span></code><a class="headerlink" href="#using-source" title="Permalink to this headline">#</a></h3>
<p>You can run all the contents of a <code class="docutils literal notranslate"><span class="pre">*.R</span></code>script file from the R command line by using <code class="docutils literal notranslate"><span class="pre">source()</span></code>.</p>
<p>★ Try sourcing <code class="docutils literal notranslate"><span class="pre">basic_io.R</span></code> (you will need to make sure you have <code class="docutils literal notranslate"><span class="pre">setwd</span></code> to your code directory):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">source</span><span class="p">(</span><span class="s">&quot;basic_io.R&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in write.table(MyData[1, ], file = &quot;../results/MyData.csv&quot;, append = TRUE):
“appending column names to file”
</pre></div>
</div>
</div>
</div>
<p>That has run OK, warning and all.</p>
<ul class="simple">
<li><p>If you get errors, read and then try to fix them. The most common problem is likely to be that you have not <code class="docutils literal notranslate"><span class="pre">setwd()</span></code> to the <code class="docutils literal notranslate"><span class="pre">code</span></code> directory.</p></li>
</ul>
<p>Alternatively, you can run the script from wherever (e.g., <code class="docutils literal notranslate"><span class="pre">data</span></code> directory) by adding the directory path to the script file name, if the script file is not in your working directory and you don’t want to change your working directory. For example, you will need <code class="docutils literal notranslate"><span class="pre">source(&quot;../code/control.R</span></code> if your working directory is <code class="docutils literal notranslate"><span class="pre">data</span></code> and not <code class="docutils literal notranslate"><span class="pre">code</span></code> (using a relative path).</p>
<p><em>Do not</em> put a <code class="docutils literal notranslate"><span class="pre">source()</span></code>command inside the script file you are sourcing, as it is then trying to run itself again and again and that’s just cruel!*</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The command <code class="docutils literal notranslate"><span class="pre">source()</span></code>has a <code class="docutils literal notranslate"><span class="pre">chdir</span></code>argument whose default value is FALSE. When set to TRUE, it will change the working directory to the directory of the file being sourced.</p>
</div>
<p>Also, if you have <code class="docutils literal notranslate"><span class="pre">source</span></code>ed a script successfully, you will see no output on in R console/terminal unless there was an error or warning, or if you explicitly asked for something to be printed. So it can be useful to add a line at the end of the script saying something like <code class="docutils literal notranslate"><span class="pre">print(&quot;Script</span> <span class="pre">complete!&quot;)</span></code>.</p>
</section>
<section id="using-rscript">
<h3>Using <code class="docutils literal notranslate"><span class="pre">Rscript</span></code><a class="headerlink" href="#using-rscript" title="Permalink to this headline">#</a></h3>
<p>You can also run R script from the UNIX/Linux terminal by calling <code class="docutils literal notranslate"><span class="pre">Rscript</span></code>. That is, while you have to be inside an R session to use the <code class="docutils literal notranslate"><span class="pre">source</span></code> command to run a script, you can run a R script directly from the UNIX/Linux terminal by calling <code class="docutils literal notranslate"><span class="pre">Rscript</span></code>.</p>
<p>This allows you to easily automate execution of your R scripts (e.g., by writing a bash script) and integrate R into a bigger computing pipeline/workflow by calling it through other tools or languages (e.g., see the <a class="reference internal" href="06-Python_II.html"><span class="doc std std-doc">Python Chapter II</span></a>).</p>
<p>If you are on Linux, try using <code class="docutils literal notranslate"><span class="pre">Rscript</span></code> to run <code class="docutils literal notranslate"><span class="pre">basic_io.R</span></code>:</p>
<ul class="simple">
<li><p>Exit from the R console using <code class="docutils literal notranslate"><span class="pre">ctrl+D</span></code>, or open a new bash terminal</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cd</span></code> to the location of <code class="docutils literal notranslate"><span class="pre">basic_io.R</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">week3/code</span></code>)</p></li>
<li><p>Then run the script using <code class="docutils literal notranslate"><span class="pre">Rscript</span> <span class="pre">basic_io.R</span></code></p></li>
</ul>
<p>Also, please have a look at <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">Rscript</span></code> in a bash terminal.</p>
</section>
<section id="running-r-in-batch-mode">
<h3>Running R in batch mode<a class="headerlink" href="#running-r-in-batch-mode" title="Permalink to this headline">#</a></h3>
<p>In addition to <code class="docutils literal notranslate"><span class="pre">Rscript</span></code>, there is another way to run you R script without opening the R console. In Mac or Linux, you can do so by typing:</p>
<p><code class="docutils literal notranslate"><span class="pre">R</span> <span class="pre">CMD</span> <span class="pre">BATCH</span> <span class="pre">MyCode.R</span> <span class="pre">MyResults.Rout</span></code></p>
<p>This will create an <code class="docutils literal notranslate"><span class="pre">MyResults.Rout</span></code>file containing all the output. On Microsoft Windows, it’s more complicated — change the path to <code class="docutils literal notranslate"><span class="pre">R.exe</span></code>and output file as needed:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;C:\Program</span> <span class="pre">Files\R\R-4.x.x\bin\R.exe&quot;</span> <span class="pre">CMD</span> <span class="pre">BATCH</span> <span class="pre">-vanilla</span> <span class="pre">-slave</span> <span class="pre">&quot;C:\PathToMyResults\Results\MyCode.R&quot;</span></code></p>
<p>Here, replace 4.x.x with the R version you have.</p>
</section>
</section>
<section id="control-flow-tools">
<h2>Control flow tools<a class="headerlink" href="#control-flow-tools" title="Permalink to this headline">#</a></h2>
<p>In R, you can write “if-then”, and “else” statements, and “for” and “while” loops like any programming language to give you finer control over your program’s “control flow”. Such statements are useful to include in functions and scripts because you may only want to do certain calculations or other tasks, under certain conditions (e.g., <code class="docutils literal notranslate"><span class="pre">if</span></code> the dataset is from a particular year, do something different).</p>
<p>Let’s look at some examples of these control flow tools in R.</p>
<p>★ Type each of the following blocks of code in a script file called <code class="docutils literal notranslate"><span class="pre">control_flow.R</span></code> and save it in your <code class="docutils literal notranslate"><span class="pre">code</span></code> directory. then run each block <em>separately</em> by sending or pasting into the R console.</p>
<section id="if-statements">
<h3><code class="docutils literal notranslate"><span class="pre">if</span></code> statements<a class="headerlink" href="#if-statements" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">&lt;-</span> <span class="kc">TRUE</span>
<span class="nf">if </span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">print </span><span class="p">(</span><span class="s">&quot;a is TRUE&quot;</span><span class="p">)</span>
<span class="p">}</span> <span class="n">else</span> <span class="p">{</span>
    <span class="nf">print </span><span class="p">(</span><span class="s">&quot;a is FALSE&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;a is TRUE&quot;
</pre></div>
</div>
</div>
</div>
<p>Note that using <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">(a)</span></code> instead of <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">(a</span> <span class="pre">==</span> <span class="pre">TRUE)</span></code> will also achieve the same result, because <code class="docutils literal notranslate"><span class="pre">a</span></code> is a Boolean variable. Compare with  <a class="reference internal" href="05-Python_I.html#python-conditionals"><span class="std std-ref">Python conditionals</span></a>.</p>
<p>In general, it is arguably a good idea to make explicit the <code class="docutils literal notranslate"><span class="pre">if</span></code> condition though.</p>
<p>You can also write an <code class="docutils literal notranslate"><span class="pre">if</span></code> statement on a single line:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">&lt;-</span> <span class="nf">runif</span><span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="c1">## Generate a uniformly distributed random number</span>
<span class="nf">if </span><span class="p">(</span><span class="n">z</span> <span class="o">&lt;=</span> <span class="m">0.5</span><span class="p">)</span> <span class="p">{</span><span class="nf">print </span><span class="p">(</span><span class="s">&quot;Less than a half&quot;</span><span class="p">)}</span>
</pre></div>
</div>
</div>
</div>
<p>But code readability is important, so avoid squeezing control flow blocks like this into a single line.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Please indent your code for readability, even if its not strictly necessary (unlike <a class="reference internal" href="05-Python_I.html"><span class="doc std std-doc">Python</span></a>). Indentation helps you see the flow of the logic, rather than flattened version, which is hard for you and anybody else to read. For example, the following code block is so much much readable than the one above:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">&lt;-</span> <span class="nf">runif</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
<span class="nf">if </span><span class="p">(</span><span class="n">z</span> <span class="o">&lt;=</span> <span class="m">0.5</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">print </span><span class="p">(</span><span class="s">&quot;Less than a half&quot;</span><span class="p">)</span>
   <span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="for-loops">
<h3><code class="docutils literal notranslate"><span class="pre">for</span></code> loops<a class="headerlink" href="#for-loops" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Control_flow#Loops">Loops</a> are really useful to repeat a task over some range of input values.</p>
<p>The following code “loops” over a range of numbers, squaring each, and then printing the result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">j</span> <span class="o">&lt;-</span> <span class="n">i</span> <span class="o">*</span> <span class="n">i</span>
    <span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s">&quot; squared is&quot;</span><span class="p">,</span> <span class="n">j</span> <span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;1  squared is 1&quot;
[1] &quot;2  squared is 4&quot;
[1] &quot;3  squared is 9&quot;
[1] &quot;4  squared is 16&quot;
[1] &quot;5  squared is 25&quot;
[1] &quot;6  squared is 36&quot;
[1] &quot;7  squared is 49&quot;
[1] &quot;8  squared is 64&quot;
[1] &quot;9  squared is 81&quot;
[1] &quot;10  squared is 100&quot;
</pre></div>
</div>
</div>
</div>
<p>What exactly is going on in the piece of code above? What are <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code>? Let’s break it down:</p>
<p>Firstly The <code class="docutils literal notranslate"><span class="pre">1:10</span></code> part simply generates a sequence, as you learned <a class="reference internal" href="#r-creating-sequences"><span class="std std-ref">previously</span></a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="o">:</span><span class="m">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li></ol>
</div></div>
</div>
<p>This is the same as using <code class="docutils literal notranslate"><span class="pre">seq(10)</span></code> (try substituting this instead of <code class="docutils literal notranslate"><span class="pre">1:10</span></code> in the above block of code).</p>
<p>Then, <code class="docutils literal notranslate"><span class="pre">j</span></code> is a temporary variable that stores the value of the number (the other temporary variable, <code class="docutils literal notranslate"><span class="pre">i</span></code>) in that iteration of the loop.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using the <code class="docutils literal notranslate"><span class="pre">:</span></code> operator or the <code class="docutils literal notranslate"><span class="pre">seq()</span></code> function pre-generates the sequence and stores it in memory, so is less efficient that Python’s <a class="reference internal" href="05-Python_I.html#python-loops"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">range</span></code> function</span></a>, which generates numbers in a sequence on a “need-to” basis.</p>
</div>
<p>You can also loop over a vector of strings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">for</span><span class="p">(</span><span class="n">species</span> <span class="n">in</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;Heliodoxa rubinoides&#39;</span><span class="p">,</span> 
                 <span class="s">&#39;Boissonneaua jardini&#39;</span><span class="p">,</span> 
                 <span class="s">&#39;Sula nebouxii&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&#39;The species is&#39;</span><span class="p">,</span> <span class="n">species</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;The species is Heliodoxa rubinoides&quot;
[1] &quot;The species is Boissonneaua jardini&quot;
[1] &quot;The species is Sula nebouxii&quot;
</pre></div>
</div>
</div>
</div>
<p>These is a random assortment of birds!</p>
<p>And here’s a for loop using apre-existing vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">v1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="s">&quot;bc&quot;</span><span class="p">,</span><span class="s">&quot;def&quot;</span><span class="p">)</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="n">v1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;a&quot;
[1] &quot;bc&quot;
[1] &quot;def&quot;
</pre></div>
</div>
</div>
</div>
</section>
<section id="while-loops">
<h3><code class="docutils literal notranslate"><span class="pre">while</span></code> loops<a class="headerlink" href="#while-loops" title="Permalink to this headline">#</a></h3>
<p>If you want to perform an operation till some condition is met, use a <code class="docutils literal notranslate"><span class="pre">while</span></code> loop:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">&lt;-</span> <span class="m">0</span>
<span class="nf">while </span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="m">10</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">i</span> <span class="o">&lt;-</span> <span class="n">i</span><span class="m">+1</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] 1
[1] 4
[1] 9
[1] 16
[1] 25
[1] 36
[1] 49
[1] 64
[1] 81
[1] 100
</pre></div>
</div>
</div>
</div>
<p>★ Now test <code class="docutils literal notranslate"><span class="pre">control_flow.R</span></code>. That is, run the script file  using <code class="docutils literal notranslate"><span class="pre">source</span></code> (and <code class="docutils literal notranslate"><span class="pre">Rscript</span></code> if on Linux).</p>
<p>If you get errors, read them carefully and fix them (this is going to be your mantra henceforth!).</p>
</section>
<section id="some-more-control-flow-tools">
<h3>Some more control flow tools<a class="headerlink" href="#some-more-control-flow-tools" title="Permalink to this headline">#</a></h3>
<p>Let’s look at some more control tools that are less commonly used, but can be useful in certain scenarios.</p>
<section id="breaking-out-of-loops">
<h4><code class="docutils literal notranslate"><span class="pre">break</span></code>ing out of loops<a class="headerlink" href="#breaking-out-of-loops" title="Permalink to this headline">#</a></h4>
<p>Often it is useful (or necessary) to <code class="docutils literal notranslate"><span class="pre">break</span></code> out of a loop when some condition is met. Use <code class="docutils literal notranslate"><span class="pre">break</span></code> (like in pretty much any other programming language, like Python) in situations when you cannot set a target number of iterations and would like to stop the loop execultion once some condition is met (as you would with a <code class="docutils literal notranslate"><span class="pre">while</span></code> loop).</p>
<p>Try this (type into <code class="docutils literal notranslate"><span class="pre">break.R</span></code> and save in <code class="docutils literal notranslate"><span class="pre">code</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">&lt;-</span> <span class="m">0</span> <span class="c1">#Initialize i</span>
    <span class="nf">while </span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="kc">Inf</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">if </span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="m">10</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">break</span> 
        <span class="p">}</span> <span class="n">else</span> <span class="p">{</span> <span class="c1"># Break out of the while loop!  </span>
            <span class="nf">cat</span><span class="p">(</span><span class="s">&quot;i equals &quot;</span> <span class="p">,</span> <span class="n">i</span> <span class="p">,</span> <span class="s">&quot; \n&quot;</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">&lt;-</span> <span class="n">i</span> <span class="o">+</span> <span class="m">1</span> <span class="c1"># Update i</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>i equals  0  
i equals  1  
i equals  2  
i equals  3  
i equals  4  
i equals  5  
i equals  6  
i equals  7  
i equals  8  
i equals  9  
</pre></div>
</div>
</div>
</div>
</section>
<section id="using-next">
<h4>Using <code class="docutils literal notranslate"><span class="pre">next</span></code><a class="headerlink" href="#using-next" title="Permalink to this headline">#</a></h4>
<p>You can also skip to next iteration of a loop. Both <code class="docutils literal notranslate"><span class="pre">next</span></code> and <code class="docutils literal notranslate"><span class="pre">break</span></code> can be used within other loops (<code class="docutils literal notranslate"> <span class="pre">while</span></code>, <code class="docutils literal notranslate"><span class="pre">for</span></code>). Try this (type into <code class="docutils literal notranslate"><span class="pre">next.R</span></code> and save in <code class="docutils literal notranslate"><span class="pre">code</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">if </span><span class="p">((</span><span class="n">i</span> <span class="o">%%</span> <span class="m">2</span><span class="p">)</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span> <span class="c1"># check if the number is odd</span>
    <span class="n">next</span> <span class="c1"># pass to next iteration of loop </span>
  <span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] 1
[1] 3
[1] 5
[1] 7
[1] 9
</pre></div>
</div>
</div>
</div>
<p>This code checks if a number is odd using the “modulo” operation and prints it if it is.</p>
</section>
</section>
</section>
<section id="writing-r-functions">
<h2>Writing R Functions<a class="headerlink" href="#writing-r-functions" title="Permalink to this headline">#</a></h2>
<p>A function is a block of re-useable code that takes an input, does something with it (or to it!), and returns the result. Like any other programming language, R lets you write your own functions. All the “commands” that you have been using, such as <code class="docutils literal notranslate"><span class="pre">ls()</span></code>, <code class="docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="docutils literal notranslate"><span class="pre">c()</span></code>, etc are basically functions. You will want to write your own function for every scenario where a particular task or set of analysis steps need to be performed again and again.<br />
The syntax for R functions is quite simple, with each function accepting “arguments” and “returning” a value.</p>
<section id="your-first-r-function">
<h3>Your first R function<a class="headerlink" href="#your-first-r-function" title="Permalink to this headline">#</a></h3>
<p>★ Type the following into a script file called  <code class="docutils literal notranslate"><span class="pre">boilerplate.R</span></code>and save it in your <code class="docutils literal notranslate"><span class="pre">code</span></code> directory:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># A boilerplate R script</span>

<span class="n">MyFunction</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">Arg1</span><span class="p">,</span> <span class="n">Arg2</span><span class="p">)</span> <span class="p">{</span>
  
  <span class="c1"># Statements involving Arg1, Arg2:</span>
  <span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Argument&quot;</span><span class="p">,</span> <span class="nf">as.character</span><span class="p">(</span><span class="n">Arg1</span><span class="p">),</span> <span class="s">&quot;is a&quot;</span><span class="p">,</span> <span class="nf">class</span><span class="p">(</span><span class="n">Arg1</span><span class="p">)))</span> <span class="c1"># print Arg1&#39;s type</span>
  <span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Argument&quot;</span><span class="p">,</span> <span class="nf">as.character</span><span class="p">(</span><span class="n">Arg2</span><span class="p">),</span> <span class="s">&quot;is a&quot;</span><span class="p">,</span> <span class="nf">class</span><span class="p">(</span><span class="n">Arg2</span><span class="p">)))</span> <span class="c1"># print Arg2&#39;s type</span>
    
  <span class="nf">return </span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">Arg1</span><span class="p">,</span> <span class="n">Arg2</span><span class="p">))</span> <span class="c1">#this is optional, but very useful</span>
<span class="p">}</span>

<span class="nf">MyFunction</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">)</span> <span class="c1">#test the function</span>
<span class="nf">MyFunction</span><span class="p">(</span><span class="s">&quot;Riki&quot;</span><span class="p">,</span><span class="s">&quot;Tiki&quot;</span><span class="p">)</span> <span class="c1">#A different test</span>
</pre></div>
</div>
<p>Note the curly brackets – these are necessary for R to know where the specification of the function starts and ends. Also, note the indentation. Not necessary (unlike Python), but recommended to make the code more readable.</p>
<p>Now enter the R console and source the script:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">source</span><span class="p">(</span><span class="s">&quot;boilerplate.R&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Argument 1 is a numeric&quot;
[1] &quot;Argument 2 is a numeric&quot;
[1] &quot;Argument Riki is a character&quot;
[1] &quot;Argument Tiki is a character&quot;
</pre></div>
</div>
</div>
</div>
<p>This will run the script, and also save your function <code class="docutils literal notranslate"><span class="pre">MyFunction</span></code> as an object into your workspace (try <code class="docutils literal notranslate"><span class="pre">ls()</span></code>, and you will see <code class="docutils literal notranslate"><span class="pre">MyFunction</span></code> appear in the list of objects):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ls</span><span class="p">(</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&quot;MyFun*&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'MyFunction'</div></div>
</div>
<p>Again, you output may be a bit different as you have been different things in your R workspace/session than I have. What matters is that you see <code class="docutils literal notranslate"><span class="pre">MyFunction</span></code> in the list of objects above.</p>
<p>Now try:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">class</span><span class="p">(</span><span class="n">MyFunction</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'function'</div></div>
</div>
<p>So, yes, <code class="docutils literal notranslate"><span class="pre">MyFunction</span></code>is a <code class="docutils literal notranslate"><span class="pre">function</span></code> objec, just as it would be in Python.</p>
</section>
<section id="functions-with-conditionals">
<h3>Functions with conditionals<a class="headerlink" href="#functions-with-conditionals" title="Permalink to this headline">#</a></h3>
<p>Here are some examples of functions with conditionals:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Checks if an integer is even</span>
<span class="n">is.even</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">if </span><span class="p">(</span><span class="n">n</span> <span class="o">%%</span> <span class="m">2</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">return</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="s">&#39;is even!&#39;</span><span class="p">))</span>
  <span class="p">}</span> <span class="n">else</span> <span class="p">{</span>
  <span class="nf">return</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="s">&#39;is odd!&#39;</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nf">is.even</span><span class="p">(</span><span class="m">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'6 is even!'</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Checks if a number is a power of 2</span>
<span class="n">is.power2</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">if </span><span class="p">(</span><span class="nf">log2</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">%%</span> <span class="m">1</span><span class="o">==</span><span class="m">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">return</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="s">&#39;is a power of 2!&#39;</span><span class="p">))</span>
  <span class="p">}</span> <span class="n">else</span> <span class="p">{</span>
  <span class="nf">return</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="s">&#39;is not a power of 2!&#39;</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nf">is.power2</span><span class="p">(</span><span class="m">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'4 is a power of 2!'</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Checks if a number is prime</span>
<span class="n">is.prime</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">if </span><span class="p">(</span><span class="n">n</span><span class="o">==</span><span class="m">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">return</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="s">&#39;is a zero!&#39;</span><span class="p">))</span>
  <span class="p">}</span> <span class="n">else</span> <span class="nf">if </span><span class="p">(</span><span class="n">n</span><span class="o">==</span><span class="m">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">return</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="s">&#39;is just a unit!&#39;</span><span class="p">))</span>
  <span class="p">}</span>
    
  <span class="n">ints</span> <span class="o">&lt;-</span> <span class="m">2</span><span class="o">:</span><span class="p">(</span><span class="n">n</span><span class="m">-1</span><span class="p">)</span>
  
  <span class="nf">if </span><span class="p">(</span><span class="nf">all</span><span class="p">(</span><span class="n">n</span><span class="o">%%</span><span class="n">ints</span><span class="o">!=</span><span class="m">0</span><span class="p">))</span> <span class="p">{</span>
    <span class="nf">return</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="s">&#39;is a prime!&#39;</span><span class="p">))</span>
  <span class="p">}</span> <span class="n">else</span> <span class="p">{</span>
  <span class="nf">return</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="s">&#39;is a composite!&#39;</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nf">is.prime</span><span class="p">(</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'3 is a prime!'</div></div>
</div>
<p>★ Run the three blocks of code in R one at a time and make sure you understand what each function is doing and how. Save all three blocks to a single script file called <code class="docutils literal notranslate"><span class="pre">R_conditionals.R</span></code> in your <code class="docutils literal notranslate"><span class="pre">code</span></code> directory, and make sure it runs using <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">Rscript</span></code> (in the Linux/Ubuntu terminal) .</p>
</section>
<section id="an-example-utility-function">
<h3>An example utility function<a class="headerlink" href="#an-example-utility-function" title="Permalink to this headline">#</a></h3>
<p>Now let’s write a script containing a more useful function:</p>
<p>★ In your text editor type the following in a file called <code class="docutils literal notranslate"><span class="pre">TreeHeight.R</span></code>, and save it in your <code class="docutils literal notranslate"><span class="pre">code</span></code>directory:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># This function calculates heights of trees given distance of each tree </span>
<span class="c1"># from its base and angle to its top, using  the trigonometric formula </span>
<span class="c1">#</span>
<span class="c1"># height = distance * tan(radians)</span>
<span class="c1">#</span>
<span class="c1"># ARGUMENTS</span>
<span class="c1"># degrees:   The angle of elevation of tree</span>
<span class="c1"># distance:  The distance from base of tree (e.g., meters)</span>
<span class="c1">#</span>
<span class="c1"># OUTPUT</span>
<span class="c1"># The heights of the tree, same units as &quot;distance&quot;</span>

<span class="n">TreeHeight</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">degrees</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">radians</span> <span class="o">&lt;-</span> <span class="n">degrees</span> <span class="o">*</span> <span class="kc">pi</span> <span class="o">/</span> <span class="m">180</span>
    <span class="n">height</span> <span class="o">&lt;-</span> <span class="n">distance</span> <span class="o">*</span> <span class="nf">tan</span><span class="p">(</span><span class="n">radians</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Tree height is:&quot;</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
  
    <span class="nf">return </span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">TreeHeight</span><span class="p">(</span><span class="m">37</span><span class="p">,</span> <span class="m">40</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">TreeHeight.R</span></code>’s two blocks (the <code class="docutils literal notranslate"><span class="pre">TreeHeight</span></code> function, and the call to the function, <code class="docutils literal notranslate"><span class="pre">TreeHeight(37,</span> <span class="pre">40)</span></code>) by pasting them sequentially into the R console. Try and understand what each line is doing.</p></li>
<li><p>Now test the whole <code class="docutils literal notranslate"><span class="pre">TreeHeight.R</span></code> script at one go using <code class="docutils literal notranslate"><span class="pre">source</span></code> and/or <code class="docutils literal notranslate"><span class="pre">Rscript</span></code> (in Linux/Ubuntu).</p></li>
</ul>
</section>
</section>
<section id="practicals">
<h2>Practicals<a class="headerlink" href="#practicals" title="Permalink to this headline">#</a></h2>
<section id="tree-heights">
<h3>Tree heights<a class="headerlink" href="#tree-heights" title="Permalink to this headline">#</a></h3>
<p>Modify the script <code class="docutils literal notranslate"><span class="pre">TreeHeight.R</span></code> so that it does the following:</p>
<ul>
<li><p>Loads <code class="docutils literal notranslate"><span class="pre">trees.csv</span></code> and calculates tree heights for all trees in the data. Note that the distances have been measured in meters. (Hint: use relative paths)).</p></li>
<li><p>Creates a csv output file called <code class="docutils literal notranslate"><span class="pre">TreeHts.csv</span></code> in <code class="docutils literal notranslate"><span class="pre">results</span></code>that contains the calculated tree heights along with the original data in the following format (only first two rows and headers shown):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Species&quot;</span>,<span class="s2">&quot;Distance.m&quot;</span>,<span class="s2">&quot;Angle.degrees&quot;</span>,<span class="s2">&quot;Tree.Height.m&quot;</span>
<span class="s2">&quot;Populus tremula&quot;</span>,31.6658337740228,41.2826361937914,27.8021161438536
<span class="s2">&quot;Quercus robur&quot;</span>,45.984992608428,44.5359166583512,45.2460250644405
</pre></div>
</div>
</li>
</ul>
<p>This script should work using either <code class="docutils literal notranslate"><span class="pre">source</span></code> or <code class="docutils literal notranslate"><span class="pre">Rscript</span></code> in Linux / UNIX.</p>
</section>
<section id="groupwork-practical-on-tree-heights">
<h3>Groupwork Practical on Tree Heights<a class="headerlink" href="#groupwork-practical-on-tree-heights" title="Permalink to this headline">#</a></h3>
<p>The goal of this practical is to make the <code class="docutils literal notranslate"><span class="pre">TreeHeight.R</span></code> script more general, so that it could be used for other datasets, not just <code class="docutils literal notranslate"><span class="pre">trees.csv</span></code>.</p>
<p>Guidelines:</p>
<ul class="simple">
<li><p>Write another R script called <code class="docutils literal notranslate"><span class="pre">get_TreeHeight.R</span></code> that takes a csv file name from the command line (e.g., <code class="docutils literal notranslate"><span class="pre">get_TreeHeight.R</span> <span class="pre">Trees.csv</span></code>) and outputs the result to a file just like <code class="docutils literal notranslate"><span class="pre">TreeHeight.R</span></code>above, but this time includes the input file name in the output file name as <code class="docutils literal notranslate"><span class="pre">InputFileName_treeheights.csv</span></code>. Note that you will have to strip the <code class="docutils literal notranslate"><span class="pre">.csv</span></code>or whatever the extension is from the filename, and also <code class="docutils literal notranslate"><span class="pre">../</span></code> etc., if you are using relative paths. (Hint: Command-line parameters are accessible within the R running environment via <code class="docutils literal notranslate"><span class="pre">commandArgs()</span></code> — so <code class="docutils literal notranslate"><span class="pre">help(commandArgs)</span></code> might be your starting point.)</p></li>
<li><p>Write a Unix shell script called <code class="docutils literal notranslate"><span class="pre">run_get_TreeHeight.sh</span></code> that tests <code class="docutils literal notranslate"><span class="pre">get_TreeHeight.R</span></code>. Include <code class="docutils literal notranslate"><span class="pre">trees.csv</span></code>as your example file. Note that <code class="docutils literal notranslate"><span class="pre">source</span></code>will not work in this case as it does not allow scripts with arguments to be run; you will have to use <code class="docutils literal notranslate"><span class="pre">Rscript</span></code>instead.</p></li>
</ul>
</section>
<section id="groupwork-practical-on-tree-heights-2">
<h3>Groupwork Practical  on Tree Heights  2<a class="headerlink" href="#groupwork-practical-on-tree-heights-2" title="Permalink to this headline">#</a></h3>
<p>Assuming you have already worked through <a class="reference internal" href="05-Python_I.html"><span class="doc std std-doc">Python Chapter I</span></a>, write a Python version of <code class="docutils literal notranslate"><span class="pre">get_TreeHeight.R</span></code> (call it <code class="docutils literal notranslate"><span class="pre">get_TreeHeight.py</span></code>). Include a test of this script into <code class="docutils literal notranslate"><span class="pre">run_get_TreeHeight.sh</span></code>.</p>
</section>
</section>
<section id="vectorization">
<span id="r-vectorization"></span><h2>Vectorization<a class="headerlink" href="#vectorization" title="Permalink to this headline">#</a></h2>
<p>R is relatively slow at cycling through a data structure such as a dataframe or matrix (e.g., by using a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop) because it is a <em>high-level, interpreted computer language</em>.</p>
<p>That is, when you execute a command in R, it needs to “read” and interpret the necessary code from scratch every single time the command is called. On the other hand, compiled languages like C know exactly what the flow of the program is because the code is pre-interpreted and ready to go before execution (i.e., the code is “compiled”).</p>
<p>For example, when you assign a new variable in R:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">&lt;-</span> <span class="m">1.0</span>
<span class="nf">class</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'numeric'</div></div>
</div>
<p>R automatically figures out that <code class="docutils literal notranslate"><span class="pre">1.0</span></code> is an floating point number, and finds a place in the system memory for it with <code class="docutils literal notranslate"><span class="pre">a</span></code> registered as a “pointer” to it.</p>
<p>In contrast, in C, for example, you would have to do so manually by giving <code class="docutils literal notranslate"><span class="pre">a</span></code> an address and space in memory:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">float</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
</pre></div>
</div>
<p><em>Vectorization is an approach where you directly apply compiled, optimized code to run an operation on a vector, matrix, or an higher-dimensional data structure (like an R array), instead of performing the operation element-wise (each row or column element one at a time) on the data structure</em>.</p>
<p>Apart from computational efficiency vectorization makes writing code more concise, easy to read, and less error prone.</p>
<p>Let’s try an example that illustrates this point.</p>
<p>★ Type (save in <code class="docutils literal notranslate"><span class="pre">Code</span></code>) as <code class="docutils literal notranslate"><span class="pre">Vectorize1.R</span></code> the following script, and run it (it sums all elements of a matrix):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">runif</span><span class="p">(</span><span class="m">1000000</span><span class="p">),</span><span class="m">1000</span><span class="p">,</span><span class="m">1000</span><span class="p">)</span>

<span class="n">SumAllElements</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">Dimensions</span> <span class="o">&lt;-</span> <span class="nf">dim</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
  <span class="n">Tot</span> <span class="o">&lt;-</span> <span class="m">0</span>
  <span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="n">Dimensions</span><span class="p">[</span><span class="m">1</span><span class="p">])</span> <span class="p">{</span>
    <span class="nf">for </span><span class="p">(</span><span class="n">j</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="n">Dimensions</span><span class="p">[</span><span class="m">2</span><span class="p">])</span> <span class="p">{</span>
      <span class="n">Tot</span> <span class="o">&lt;-</span> <span class="n">Tot</span> <span class="o">+</span> <span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nf">return </span><span class="p">(</span><span class="n">Tot</span><span class="p">)</span>
<span class="p">}</span>
 
<span class="nf">print</span><span class="p">(</span><span class="s">&quot;Using loops, the time taken is:&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">system.time</span><span class="p">(</span><span class="nf">SumAllElements</span><span class="p">(</span><span class="n">M</span><span class="p">)))</span>

<span class="nf">print</span><span class="p">(</span><span class="s">&quot;Using the in-built vectorized function, the time taken is:&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">system.time</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">M</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Using loops, the time taken is:&quot;
   user  system elapsed 
   0.08    0.00    0.08 
[1] &quot;Using the in-built vectorized function, the time taken is:&quot;
   user  system elapsed 
  0.001   0.000   0.001 
</pre></div>
</div>
</div>
</div>
<p>Note the <code class="docutils literal notranslate"><span class="pre">system.time</span></code> R function: it calculates how much time your code takes. This time will vary with every run, and every computer that this code is run on (so your times will be a bit different than what I got).</p>
<p>Both <code class="docutils literal notranslate"><span class="pre">SumAllElements()</span></code> and <code class="docutils literal notranslate"><span class="pre">sum()</span></code> approaches are correct, and will give you the right answer. However, the inbuilt function <code class="docutils literal notranslate"><span class="pre">sum()</span></code>  is about 100 times faster than the other, because it uses vectorization, avoiding the amount of looping that <code class="docutils literal notranslate"><span class="pre">SumAllElements()</span></code> uses.</p>
<p>In effect, of course, the computer still has to run loops. However, this running of the loops is encapsulated in a pre-complied program that R calls. These programs are written in more primitive (and therefore, faster) languages like Fortran and C. For example <code class="docutils literal notranslate"><span class="pre">sum</span></code> is actually written in C if you look under the hood.</p>
<p>In R, even if you should try to avoid loops, in practice, it is often much easier to throw in a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop, and <em>then</em> “optimize” the code to avoid the loop if the running time is not satisfactory. Therefore, it is still essential that you to become familiar with loops and looping as you learned in the sections above.</p>
<section id="pre-allocation">
<h3>Pre-allocation<a class="headerlink" href="#pre-allocation" title="Permalink to this headline">#</a></h3>
<p>And if you are using loops, one operation that is slow in R (and somewhat slow in all languages) is memory allocation for a particular variable that will change during looping (e.g., a variable that is a dataframe). So writing a for loop that resizes a vector repeatedly makes R re-allocate memory repeatedly, which makes it slow. Try this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">NoPreallocFun</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">a</span> <span class="o">&lt;-</span> <span class="nf">vector</span><span class="p">()</span> <span class="c1"># empty vector</span>
    <span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">a</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="c1"># concatenate</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="nf">object.size</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nf">system.time</span><span class="p">(</span><span class="nf">NoPreallocFun</span><span class="p">(</span><span class="m">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] 1
56 bytes
[1] 1 2
56 bytes
[1] 1 2 3
64 bytes
[1] 1 2 3 4
64 bytes
[1] 1 2 3 4 5
80 bytes
[1] 1 2 3 4 5 6
80 bytes
[1] 1 2 3 4 5 6 7
80 bytes
[1] 1 2 3 4 5 6 7 8
80 bytes
[1] 1 2 3 4 5 6 7 8 9
96 bytes
 [1]  1  2  3  4  5  6  7  8  9 10
96 bytes
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   user  system elapsed 
  0.011   0.000   0.011 
</pre></div>
</div>
</div>
</div>
<p>Here, in each repetition of the for loop, you can see that R has to re-size the vector and re-allocate (more) memory. It has to find the vector in memory, create a new vector that will fit more data, copy the old data over, insert the new data, and erase the old vector. This can get very slow as vectors get big.</p>
<p>On the other hand, if you “pre-allocate” a vector that fits all the values, R doesn’t have to re-allocate memory each iteration. Here’s how you’d do that for the above case:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">PreallocFun</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">a</span> <span class="o">&lt;-</span> <span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="c1"># pre-allocated vector</span>
    <span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">i</span> <span class="c1"># assign</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="nf">object.size</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nf">system.time</span><span class="p">(</span><span class="nf">PreallocFun</span><span class="p">(</span><span class="m">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [1]  1 NA NA NA NA NA NA NA NA NA
96 bytes
 [1]  1  2 NA NA NA NA NA NA NA NA
96 bytes
 [1]  1  2  3 NA NA NA NA NA NA NA
96 bytes
 [1]  1  2  3  4 NA NA NA NA NA NA
96 bytes
 [1]  1  2  3  4  5 NA NA NA NA NA
96 bytes
 [1]  1  2  3  4  5  6 NA NA NA NA
96 bytes
 [1]  1  2  3  4  5  6  7 NA NA NA
96 bytes
 [1]  1  2  3  4  5  6  7  8 NA NA
96 bytes
 [1]  1  2  3  4  5  6  7  8  9 NA
96 bytes
 [1]  1  2  3  4  5  6  7  8  9 10
96 bytes
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   user  system elapsed 
  0.006   0.000   0.005 
</pre></div>
</div>
</div>
</div>
<p>★ Write the above two blocks of code into a script called <code class="docutils literal notranslate"><span class="pre">preallocate.R</span></code>. You can’t really see the difference in timing here using <code class="docutils literal notranslate"><span class="pre">system.time()</span></code> because the vector is really small (just 10 elements), and the <code class="docutils literal notranslate"><span class="pre">print()</span></code> commands take up most of the time. To really see the difference in efficiency between the two functions, increase the iterations in your script from 10 to 1000, and suppress the print commands. Make this modification to your script. The modified script should print just the outputs of the two <code class="docutils literal notranslate"><span class="pre">system.time()</span></code> calls.</p>
<p>Fortunately, R has several functions that can operate on entire vectors and matrices without requiring looping (Vectorization). That is, vectorizing a computer program means you write it such that as many operations as possible are applied to whole data structure (vectors, matrices, dataframes, lists, etc) at one go, instead of its individual elements.</p>
<p>You will learn about some important R functions that allow vectorization in the following sections.</p>
</section>
<section id="the-apply-family-of-functions">
<h3>The <code class="docutils literal notranslate"><span class="pre">*apply</span></code> family of functions<a class="headerlink" href="#the-apply-family-of-functions" title="Permalink to this headline">#</a></h3>
<p>There are a family of functions called <code class="docutils literal notranslate"><span class="pre">*apply</span></code> in R that vectorize your code for you. These functions are described in the help files (e.g. <code class="docutils literal notranslate"><span class="pre">?apply</span></code>).</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">apply</span></code> can be used when you want to apply a function to the rows or columns of a matrix (and higher-dimensional analogues – remember arrays!). This is not generally advisable for data frames as it will first need to coerce the data frame to a matrix first.</p>
<p>Let us try using applying the same function to rows/colums of a matrix using <code class="docutils literal notranslate"><span class="pre">apply</span></code>.</p>
<p>★ Type the following in a script file called <code class="docutils literal notranslate"><span class="pre">apply1.R</span></code>, save it to your <code class="docutils literal notranslate"><span class="pre">Code</span></code> directory, and run it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">## Build a random matrix</span>
<span class="n">M</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">rnorm</span><span class="p">(</span><span class="m">100</span><span class="p">),</span> <span class="m">10</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>

<span class="c1">## Take the mean of each row</span>
<span class="n">RowMeans</span> <span class="o">&lt;-</span> <span class="nf">apply</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>
<span class="nf">print </span><span class="p">(</span><span class="n">RowMeans</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [1]  0.36031151  0.04436538  0.22147423  0.20493801  0.16210725  0.04860134
 [7]  0.41767343 -0.30198204  0.17624371 -0.12782576
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">## Now the variance</span>
<span class="n">RowVars</span> <span class="o">&lt;-</span> <span class="nf">apply</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>
<span class="nf">print </span><span class="p">(</span><span class="n">RowVars</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [1] 0.8054302 0.5757168 0.3312622 0.4285847 0.9819718 0.9878042 0.6637336
 [8] 0.8063847 0.4404945 1.3378551
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">## By column</span>
<span class="n">ColMeans</span> <span class="o">&lt;-</span> <span class="nf">apply</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>
<span class="nf">print </span><span class="p">(</span><span class="n">ColMeans</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [1]  0.225188540 -0.005593872  0.070236505  0.540658047  0.207704657
 [6] -0.039456952 -0.308016915 -0.052139549 -0.017257915  0.584584511
</pre></div>
</div>
</div>
</div>
<p>That was using <code class="docutils literal notranslate"><span class="pre">apply</span></code> on some of R’s inbuilt functions. You can use apply to define your own functions. Let’s try it.</p>
<p>★ Type the following in a script file called <code class="docutils literal notranslate"><span class="pre">apply2.R</span></code>, save it to your <code class="docutils literal notranslate"><span class="pre">Code</span></code> directory, and run it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">SomeOperation</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="p">{</span> <span class="c1"># (What does this function do?)</span>
  <span class="nf">if </span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">#note that sum(v) is a single (scalar) value</span>
    <span class="nf">return </span><span class="p">(</span><span class="n">v</span> <span class="o">*</span> <span class="m">100</span><span class="p">)</span>
  <span class="p">}</span> <span class="n">else</span> <span class="p">{</span> 
  <span class="nf">return </span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">M</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">rnorm</span><span class="p">(</span><span class="m">100</span><span class="p">),</span> <span class="m">10</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
<span class="nf">print </span><span class="p">(</span><span class="nf">apply</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">SomeOperation</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            [,1]        [,2]       [,3]        [,4]       [,5]      [,6]
 [1,] -234.39455   31.662431  0.7233882 -0.94436410 -1.4572646 -20.07141
 [2,]  180.15974   83.582155  0.3644622  1.19740008 -0.3927685 -98.37526
 [3,]   16.28549  143.665254  0.3018886 -1.06216206 -2.3448302 224.24758
 [4,]  -28.24259   -6.671888  0.4672368  0.63864658  0.4280011 -86.77100
 [5,]  237.42028  148.139235  1.2226815  0.04541425 -0.3694419 -17.01924
 [6,]   67.62704   14.332068 -0.3192625 -1.51307536 -1.8384410 -15.53040
 [7,]  107.61127   53.433940 -1.8648914 -0.10926190 -1.3273339  87.13306
 [8,]   39.42281 -101.533491  0.1049022 -0.58231320 -0.1164919  80.88842
 [9,]   85.01566  177.863389 -2.0382452 -0.06725732  0.6842362 -39.28277
[10,]   79.61237   67.051809  0.3626656  0.40823357 -1.1903160  27.77324
             [,7]       [,8]        [,9]       [,10]
 [1,] -0.90120256  18.385375  0.04279667    3.696104
 [2,] -0.48180877  74.636647 -0.97886275  147.825300
 [3,] -0.65661220   9.031228  0.69408658   57.520424
 [4,] -0.49917243 -94.532163 -0.41680049  128.188540
 [5,]  0.07449752 163.795799 -0.57998084  -22.925171
 [6,] -0.31465171 -82.500457  0.09081916 -106.962944
 [7,]  0.76765184   9.721098 -1.81725821   42.298713
 [8,]  1.99041007  73.372002 -0.29073832  133.662999
 [9,]  0.93981016 -28.824632  1.31045316  129.069991
[10,] -1.45123295 126.623928 -1.11812957   69.367728
</pre></div>
</div>
</div>
</div>
<p>Thus, the function <code class="docutils literal notranslate"><span class="pre">SomeOperation</span></code> takes as input <code class="docutils literal notranslate"><span class="pre">v</span></code>. Then if the sum of v is greater than zero, it multiplies that value by 100. So if <code class="docutils literal notranslate"><span class="pre">v</span></code> has positive and negative numbers, and the sum comes out to be positive, only then does it multiply all the values in <code class="docutils literal notranslate"><span class="pre">v</span></code> by 100 and return them.</p>
<p>There are many other methods: <code class="docutils literal notranslate"><span class="pre">lapply</span></code>, <code class="docutils literal notranslate"><span class="pre">sapply</span></code>, <code class="docutils literal notranslate"><span class="pre">eapply</span></code>, etc. Each is best for a given data type. For example, <code class="docutils literal notranslate"><span class="pre">lapply</span></code> abd <code class="docutils literal notranslate"><span class="pre">sapply</span></code> are designed for R lists. Have a look at <a class="reference external" href="https://stackoverflow.com/questions/3505701/grouping-functions-tapply-by-aggregate-and-the-apply-family">this Stackoveflow thread</a>
for some guidelines.</p>
<section id="a-vectorization-example">
<h4>A vectorization example<a class="headerlink" href="#a-vectorization-example" title="Permalink to this headline">#</a></h4>
<p>Let’s try an example of vectorization involving <code class="docutils literal notranslate"><span class="pre">lapply</span></code> and <code class="docutils literal notranslate"><span class="pre">sapply</span></code>. Both of these <em>apply</em> a function to <em>each element of a list</em>, but the former returns a list, while the latter returns a vector.</p>
<p>We will also see how <a class="reference internal" href="#r-random-numbers"><span class="std std-ref">sampling random numbers</span></a> works in the process of trying out this example.</p>
<p>★ Type the following blocks of code into a single script called <code class="docutils literal notranslate"><span class="pre">sample.R</span></code> and save in <code class="docutils literal notranslate"><span class="pre">code</span></code>.</p>
<p>First some functions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">######### Functions ##########</span>

<span class="c1">## A function to take a sample of size n from a population &quot;popn&quot; and return its mean</span>
<span class="n">myexperiment</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">pop_sample</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
    <span class="nf">return</span><span class="p">(</span><span class="nf">mean</span><span class="p">(</span><span class="n">pop_sample</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1">## Calculate means using a FOR loop on a vector without preallocation:</span>
<span class="n">loopy_sample1</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">result1</span> <span class="o">&lt;-</span> <span class="nf">vector</span><span class="p">()</span> <span class="c1">#Initialize empty vector of size 1 </span>
    <span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="n">num</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">result1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">result1</span><span class="p">,</span> <span class="nf">myexperiment</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="nf">return</span><span class="p">(</span><span class="n">result1</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">## To run &quot;num&quot; iterations of the experiment using a FOR loop on a vector with preallocation:</span>
<span class="n">loopy_sample2</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">result2</span> <span class="o">&lt;-</span> <span class="nf">vector</span><span class="p">(,</span><span class="n">num</span><span class="p">)</span> <span class="c1">#Preallocate expected size</span>
    <span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="n">num</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">result2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="nf">myexperiment</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="nf">return</span><span class="p">(</span><span class="n">result2</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">## To run &quot;num&quot; iterations of the experiment using a FOR loop on a list with preallocation:</span>
<span class="n">loopy_sample3</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">result3</span> <span class="o">&lt;-</span> <span class="nf">vector</span><span class="p">(</span><span class="s">&quot;list&quot;</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span> <span class="c1">#Preallocate expected size</span>
    <span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="n">num</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">result3</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span> <span class="o">&lt;-</span> <span class="nf">myexperiment</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="nf">return</span><span class="p">(</span><span class="n">result3</span><span class="p">)</span>
<span class="p">}</span>


<span class="c1">## To run &quot;num&quot; iterations of the experiment using vectorization with lapply:</span>
<span class="n">lapply_sample</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">result4</span> <span class="o">&lt;-</span> <span class="nf">lapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">num</span><span class="p">,</span> <span class="nf">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="nf">myexperiment</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="nf">return</span><span class="p">(</span><span class="n">result4</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">## To run &quot;num&quot; iterations of the experiment using vectorization with sapply:</span>
<span class="n">sapply_sample</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">result5</span> <span class="o">&lt;-</span> <span class="nf">sapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">num</span><span class="p">,</span> <span class="nf">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="nf">myexperiment</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="nf">return</span><span class="p">(</span><span class="n">result5</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p><em>Think carefully about what each of these functions does.</em></p>
<p>Now let’s generate a population. To get the same result every time, let’s set seed (you might want to review <a class="reference internal" href="#r-random-numbers"><span class="std std-ref">this section</span></a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">12345</span><span class="p">)</span>
<span class="n">popn</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">10000</span><span class="p">)</span> <span class="c1"># Generate the population</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">popn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/07-R_296_0.png" src="../_images/07-R_296_0.png" />
</div>
</div>
<p>And run and time the different functions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">&lt;-</span> <span class="m">100</span> <span class="c1"># sample size for each experiment</span>
<span class="n">num</span> <span class="o">&lt;-</span> <span class="m">10000</span> <span class="c1"># Number of times to rerun the experiment</span>

<span class="nf">print</span><span class="p">(</span><span class="s">&quot;Using loops without preallocation on a vector took:&quot;</span> <span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">system.time</span><span class="p">(</span><span class="nf">loopy_sample1</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">num</span><span class="p">)))</span>

<span class="nf">print</span><span class="p">(</span><span class="s">&quot;Using loops with preallocation on a vector took:&quot;</span> <span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">system.time</span><span class="p">(</span><span class="nf">loopy_sample2</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">num</span><span class="p">)))</span>

<span class="nf">print</span><span class="p">(</span><span class="s">&quot;Using loops with preallocation on a list took:&quot;</span> <span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">system.time</span><span class="p">(</span><span class="nf">loopy_sample3</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">num</span><span class="p">)))</span>

<span class="nf">print</span><span class="p">(</span><span class="s">&quot;Using the vectorized sapply function (on a list) took:&quot;</span> <span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">system.time</span><span class="p">(</span><span class="nf">sapply_sample</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">num</span><span class="p">)))</span>

<span class="nf">print</span><span class="p">(</span><span class="s">&quot;Using the vectorized lapply function (on a list) took:&quot;</span> <span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">system.time</span><span class="p">(</span><span class="nf">lapply_sample</span><span class="p">(</span><span class="n">popn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">num</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Using loops without preallocation on a vector took:&quot;
   user  system elapsed 
  0.596   0.000   0.651 
[1] &quot;Using loops with preallocation on a vector took:&quot;
   user  system elapsed 
  0.378   0.000   0.384 
[1] &quot;Using loops with preallocation on a list took:&quot;
   user  system elapsed 
  0.347   0.000   0.347 
[1] &quot;Using the vectorized sapply function (on a list) took:&quot;
   user  system elapsed 
  0.299   0.000   0.300 
[1] &quot;Using the vectorized lapply function (on a list) took:&quot;
   user  system elapsed 
  0.340   0.000   0.342 
</pre></div>
</div>
</div>
</div>
<p><em>Note that these times will be different on your computer because they depend on the computer’s hardware and software (especially, the operating system), as well as what other processes are running.</em></p>
<p>★ Run <code class="docutils literal notranslate"><span class="pre">sample.R</span></code> using <code class="docutils literal notranslate"><span class="pre">source</span></code> and/or <code class="docutils literal notranslate"><span class="pre">Rscript</span></code> and make sure it works.</p>
<p>Rerun the script a few times, first by fixing the <code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">num</span></code> parameters, and then also by varying them. Compare the times you get from these repeated runs of the script and think about which approach is the most efficient and why. Clearly, the loopy, witout pre-allocation apporach is usually (but not always) going to be bad, while the others are pretty comparable.</p>
</section>
<section id="the-tapply-function">
<h4>The <code class="docutils literal notranslate"><span class="pre">tapply</span></code> function<a class="headerlink" href="#the-tapply-function" title="Permalink to this headline">#</a></h4>
<p>Let’s look at <code class="docutils literal notranslate"><span class="pre">tapply</span></code>, which is particularly useful because it allows you to apply a function to subsets of a vector in a dataframe, with the subsets defined by some other vector in the same dataframe, usually a factor (this could be useful for pound hill data analysis that’s coming up, for example).</p>
<p>This makes it a bit of a different member of the <code class="docutils literal notranslate"><span class="pre">*apply</span></code> family. Try this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="m">20</span> <span class="c1"># a vector</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li></ol>
</div></div>
</div>
<p>Now create a <code class="docutils literal notranslate"><span class="pre">factor</span></code> type variable (of the same length) defining groups:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="kc">letters</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">],</span> <span class="n">each</span> <span class="o">=</span> <span class="m">4</span><span class="p">))</span> 
<span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>a</li><li>a</li><li>a</li><li>a</li><li>b</li><li>b</li><li>b</li><li>b</li><li>c</li><li>c</li><li>c</li><li>c</li><li>d</li><li>d</li><li>d</li><li>d</li><li>e</li><li>e</li><li>e</li><li>e</li></ol>

<details>
	<summary style=display:list-item;cursor:pointer>
		<strong>Levels</strong>:
	</summary>
	<style>
	.list-inline {list-style: none; margin:0; padding: 0}
	.list-inline>li {display: inline-block}
	.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
	</style>
	<ol class=list-inline><li>'a'</li><li>'b'</li><li>'c'</li><li>'d'</li><li>'e'</li></ol>
</details></div></div>
</div>
<p>Now add up the values in x within each subgroup defined by y:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">tapply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sum</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>a</dt><dd>10</dd><dt>b</dt><dd>26</dd><dt>c</dt><dd>42</dd><dt>d</dt><dd>58</dd><dt>e</dt><dd>74</dd></dl>
</div></div>
</div>
</section>
</section>
<section id="using-by">
<h3>Using <code class="docutils literal notranslate"><span class="pre">by</span></code><a class="headerlink" href="#using-by" title="Permalink to this headline">#</a></h3>
<p>You can also do something similar to <code class="docutils literal notranslate"><span class="pre">tapply</span></code> with the <code class="docutils literal notranslate"><span class="pre">by</span></code> function, i.e., apply a function to a dataframe using some factor to define the subsets. Try this:</p>
<p>First import some data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">attach</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>
<span class="n">iris</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following objects are masked from iris (pos = 3):

    Petal.Length, Petal.Width, Sepal.Length, Sepal.Width, Species
</pre></div>
</div>
<div class="output text_html"><table>
<caption>A data.frame: 150 × 5</caption>
<thead>
	<tr><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th></tr>
</thead>
<tbody>
	<tr><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>4.9</td><td>3.0</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>5.0</td><td>3.6</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>5.4</td><td>3.9</td><td>1.7</td><td>0.4</td><td>setosa</td></tr>
	<tr><td>4.6</td><td>3.4</td><td>1.4</td><td>0.3</td><td>setosa</td></tr>
	<tr><td>5.0</td><td>3.4</td><td>1.5</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>4.4</td><td>2.9</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>4.9</td><td>3.1</td><td>1.5</td><td>0.1</td><td>setosa</td></tr>
	<tr><td>5.4</td><td>3.7</td><td>1.5</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>4.8</td><td>3.4</td><td>1.6</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>4.8</td><td>3.0</td><td>1.4</td><td>0.1</td><td>setosa</td></tr>
	<tr><td>4.3</td><td>3.0</td><td>1.1</td><td>0.1</td><td>setosa</td></tr>
	<tr><td>5.8</td><td>4.0</td><td>1.2</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>5.7</td><td>4.4</td><td>1.5</td><td>0.4</td><td>setosa</td></tr>
	<tr><td>5.4</td><td>3.9</td><td>1.3</td><td>0.4</td><td>setosa</td></tr>
	<tr><td>5.1</td><td>3.5</td><td>1.4</td><td>0.3</td><td>setosa</td></tr>
	<tr><td>5.7</td><td>3.8</td><td>1.7</td><td>0.3</td><td>setosa</td></tr>
	<tr><td>5.1</td><td>3.8</td><td>1.5</td><td>0.3</td><td>setosa</td></tr>
	<tr><td>5.4</td><td>3.4</td><td>1.7</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>5.1</td><td>3.7</td><td>1.5</td><td>0.4</td><td>setosa</td></tr>
	<tr><td>4.6</td><td>3.6</td><td>1.0</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>5.1</td><td>3.3</td><td>1.7</td><td>0.5</td><td>setosa</td></tr>
	<tr><td>4.8</td><td>3.4</td><td>1.9</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>5.0</td><td>3.0</td><td>1.6</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>5.0</td><td>3.4</td><td>1.6</td><td>0.4</td><td>setosa</td></tr>
	<tr><td>5.2</td><td>3.5</td><td>1.5</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>5.2</td><td>3.4</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>4.7</td><td>3.2</td><td>1.6</td><td>0.2</td><td>setosa</td></tr>
	<tr><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr>
	<tr><td>6.9</td><td>3.2</td><td>5.7</td><td>2.3</td><td>virginica</td></tr>
	<tr><td>5.6</td><td>2.8</td><td>4.9</td><td>2.0</td><td>virginica</td></tr>
	<tr><td>7.7</td><td>2.8</td><td>6.7</td><td>2.0</td><td>virginica</td></tr>
	<tr><td>6.3</td><td>2.7</td><td>4.9</td><td>1.8</td><td>virginica</td></tr>
	<tr><td>6.7</td><td>3.3</td><td>5.7</td><td>2.1</td><td>virginica</td></tr>
	<tr><td>7.2</td><td>3.2</td><td>6.0</td><td>1.8</td><td>virginica</td></tr>
	<tr><td>6.2</td><td>2.8</td><td>4.8</td><td>1.8</td><td>virginica</td></tr>
	<tr><td>6.1</td><td>3.0</td><td>4.9</td><td>1.8</td><td>virginica</td></tr>
	<tr><td>6.4</td><td>2.8</td><td>5.6</td><td>2.1</td><td>virginica</td></tr>
	<tr><td>7.2</td><td>3.0</td><td>5.8</td><td>1.6</td><td>virginica</td></tr>
	<tr><td>7.4</td><td>2.8</td><td>6.1</td><td>1.9</td><td>virginica</td></tr>
	<tr><td>7.9</td><td>3.8</td><td>6.4</td><td>2.0</td><td>virginica</td></tr>
	<tr><td>6.4</td><td>2.8</td><td>5.6</td><td>2.2</td><td>virginica</td></tr>
	<tr><td>6.3</td><td>2.8</td><td>5.1</td><td>1.5</td><td>virginica</td></tr>
	<tr><td>6.1</td><td>2.6</td><td>5.6</td><td>1.4</td><td>virginica</td></tr>
	<tr><td>7.7</td><td>3.0</td><td>6.1</td><td>2.3</td><td>virginica</td></tr>
	<tr><td>6.3</td><td>3.4</td><td>5.6</td><td>2.4</td><td>virginica</td></tr>
	<tr><td>6.4</td><td>3.1</td><td>5.5</td><td>1.8</td><td>virginica</td></tr>
	<tr><td>6.0</td><td>3.0</td><td>4.8</td><td>1.8</td><td>virginica</td></tr>
	<tr><td>6.9</td><td>3.1</td><td>5.4</td><td>2.1</td><td>virginica</td></tr>
	<tr><td>6.7</td><td>3.1</td><td>5.6</td><td>2.4</td><td>virginica</td></tr>
	<tr><td>6.9</td><td>3.1</td><td>5.1</td><td>2.3</td><td>virginica</td></tr>
	<tr><td>5.8</td><td>2.7</td><td>5.1</td><td>1.9</td><td>virginica</td></tr>
	<tr><td>6.8</td><td>3.2</td><td>5.9</td><td>2.3</td><td>virginica</td></tr>
	<tr><td>6.7</td><td>3.3</td><td>5.7</td><td>2.5</td><td>virginica</td></tr>
	<tr><td>6.7</td><td>3.0</td><td>5.2</td><td>2.3</td><td>virginica</td></tr>
	<tr><td>6.3</td><td>2.5</td><td>5.0</td><td>1.9</td><td>virginica</td></tr>
	<tr><td>6.5</td><td>3.0</td><td>5.2</td><td>2.0</td><td>virginica</td></tr>
	<tr><td>6.2</td><td>3.4</td><td>5.4</td><td>2.3</td><td>virginica</td></tr>
	<tr><td>5.9</td><td>3.0</td><td>5.1</td><td>1.8</td><td>virginica</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Now run the <code class="docutils literal notranslate"><span class="pre">colMeans</span></code> function (it is better for dataframes than just mean) on multiple columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">by</span><span class="p">(</span><span class="n">iris</span><span class="p">[,</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span> <span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">,</span> <span class="n">colMeans</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iris$Species: setosa
Sepal.Length  Sepal.Width 
       5.006        3.428 
------------------------------------------------------------ 
iris$Species: versicolor
Sepal.Length  Sepal.Width 
       5.936        2.770 
------------------------------------------------------------ 
iris$Species: virginica
Sepal.Length  Sepal.Width 
       6.588        2.974 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">by</span><span class="p">(</span><span class="n">iris</span><span class="p">[,</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span> <span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span> <span class="n">colMeans</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iris$Petal.Width: 0.1
Sepal.Length  Sepal.Width 
        4.82         3.36 
------------------------------------------------------------ 
iris$Petal.Width: 0.2
Sepal.Length  Sepal.Width 
    4.972414     3.379310 
------------------------------------------------------------ 
iris$Petal.Width: 0.3
Sepal.Length  Sepal.Width 
    4.971429     3.328571 
------------------------------------------------------------ 
iris$Petal.Width: 0.4
Sepal.Length  Sepal.Width 
    5.300000     3.785714 
------------------------------------------------------------ 
iris$Petal.Width: 0.5
Sepal.Length  Sepal.Width 
         5.1          3.3 
------------------------------------------------------------ 
iris$Petal.Width: 0.6
Sepal.Length  Sepal.Width 
         5.0          3.5 
------------------------------------------------------------ 
iris$Petal.Width: 1
Sepal.Length  Sepal.Width 
    5.414286     2.371429 
------------------------------------------------------------ 
iris$Petal.Width: 1.1
Sepal.Length  Sepal.Width 
    5.400000     2.466667 
------------------------------------------------------------ 
iris$Petal.Width: 1.2
Sepal.Length  Sepal.Width 
        5.78         2.74 
------------------------------------------------------------ 
iris$Petal.Width: 1.3
Sepal.Length  Sepal.Width 
    5.884615     2.746154 
------------------------------------------------------------ 
iris$Petal.Width: 1.4
Sepal.Length  Sepal.Width 
      6.3250       2.9125 
------------------------------------------------------------ 
iris$Petal.Width: 1.5
Sepal.Length  Sepal.Width 
    6.183333     2.816667 
------------------------------------------------------------ 
iris$Petal.Width: 1.6
Sepal.Length  Sepal.Width 
       6.375        3.100 
------------------------------------------------------------ 
iris$Petal.Width: 1.7
Sepal.Length  Sepal.Width 
        5.80         2.75 
------------------------------------------------------------ 
iris$Petal.Width: 1.8
Sepal.Length  Sepal.Width 
    6.400000     2.941667 
------------------------------------------------------------ 
iris$Petal.Width: 1.9
Sepal.Length  Sepal.Width 
        6.34         2.68 
------------------------------------------------------------ 
iris$Petal.Width: 2
Sepal.Length  Sepal.Width 
    6.650000     3.016667 
------------------------------------------------------------ 
iris$Petal.Width: 2.1
Sepal.Length  Sepal.Width 
    6.916667     3.033333 
------------------------------------------------------------ 
iris$Petal.Width: 2.2
Sepal.Length  Sepal.Width 
    6.866667     3.200000 
------------------------------------------------------------ 
iris$Petal.Width: 2.3
Sepal.Length  Sepal.Width 
      6.9125       3.0875 
------------------------------------------------------------ 
iris$Petal.Width: 2.4
Sepal.Length  Sepal.Width 
    6.266667     3.100000 
------------------------------------------------------------ 
iris$Petal.Width: 2.5
Sepal.Length  Sepal.Width 
    6.733333     3.400000 
</pre></div>
</div>
</div>
</div>
</section>
<section id="using-replicate">
<h3>Using <code class="docutils literal notranslate"><span class="pre">replicate</span></code><a class="headerlink" href="#using-replicate" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">replicate</span></code> function is useful to avoid a loop for function that typically involves random number generation (more on this below). For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">replicate</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="nf">runif</span><span class="p">(</span><span class="m">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A matrix: 5 × 10 of type dbl</caption>
<tbody>
	<tr><td>0.05779543</td><td>0.79875145</td><td>0.48499984</td><td>0.86907132</td><td>0.1283642</td><td>0.0009810759</td><td>0.6536405</td><td>0.8683811</td><td>0.8454915</td><td>0.8783501</td></tr>
	<tr><td>0.45615105</td><td>0.57098740</td><td>0.23039036</td><td>0.30154024</td><td>0.2747319</td><td>0.2428520240</td><td>0.9098087</td><td>0.6079378</td><td>0.6468676</td><td>0.7984627</td></tr>
	<tr><td>0.56282049</td><td>0.04613426</td><td>0.62504519</td><td>0.04747557</td><td>0.7813629</td><td>0.8418969549</td><td>0.4024599</td><td>0.6946761</td><td>0.6771371</td><td>0.2471511</td></tr>
	<tr><td>0.47753585</td><td>0.69846828</td><td>0.46303515</td><td>0.25758230</td><td>0.2651486</td><td>0.1114152884</td><td>0.1513297</td><td>0.3396491</td><td>0.8450003</td><td>0.3601890</td></tr>
	<tr><td>0.63433648</td><td>0.40640785</td><td>0.07475354</td><td>0.04436429</td><td>0.0915491</td><td>0.2450728263</td><td>0.4717760</td><td>0.4990844</td><td>0.7130802</td><td>0.9336190</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>That is, you just generated 10 sets (columns) of 5 uniformly-distributed random numbers (a 10 <span class="math notranslate nohighlight">\(\times\)</span> 5 matrix).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The actual numbers you get will be different from the ones you see here unless you set the random number seed <a class="reference internal" href="#r-random-numbers"><span class="std std-ref">as we learned above</span></a>.</p>
</div>
</section>
<section id="using-plyr-and-ddply">
<h3>Using <code class="docutils literal notranslate"><span class="pre">plyr</span></code> and <code class="docutils literal notranslate"><span class="pre">ddply</span></code><a class="headerlink" href="#using-plyr-and-ddply" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">plyr</span></code> package combines the functionality of the <code class="docutils literal notranslate"><span class="pre">*apply</span></code> family, into a few handy functions. Look up the <a class="reference external" href="http://plyr.had.co.nz/">web page</a>.</p>
<p>In particular, <code class="docutils literal notranslate"><span class="pre">ddply</span></code> is very useful, because for each subset of a data frame, it applies a function and then combines results into another data frame. In other words, “ddply” means: take a data frame, split it up, do something to it, and return a data frame. Look up <a class="reference external" href="http://seananderson.ca/2013/12/01/plyr.html">this</a> and
<a class="reference external" href="https://www.r-bloggers.com/transforming-subsets-of-data-in-r-with-by-ddply-and-data-table/">this</a>
for examples.    There you will also see a comparison of speed of <code class="docutils literal notranslate"><span class="pre">ddply</span></code> vs <code class="docutils literal notranslate"><span class="pre">by</span></code> at the latter web page; <code class="docutils literal notranslate"><span class="pre">ddply</span></code> is actually slower than other vectorized methods, as it trades-off compactness of use for some of the speed of vectorization! Indeed, overall functions in <code class="docutils literal notranslate"><span class="pre">plyr</span></code> can be slow if you are working with very large datasets that involve a lot of subsetting (analyses by many groups or grouping variables).</p>
<p>The base <code class="docutils literal notranslate"><span class="pre">*apply</span></code> functions remain useful and worth knowing even if you do get into <code class="docutils literal notranslate"><span class="pre">plyr</span></code> or better still, <code class="docutils literal notranslate"><span class="pre">dplyr</span></code>, which we will see in the <a class="reference internal" href="08-Data_R.html"><span class="doc std std-doc">Data chapter</span></a>.</p>
</section>
</section>
<section id="id1">
<h2>Practicals<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<section id="a-vectorization-challenge">
<h3>A vectorization challenge<a class="headerlink" href="#a-vectorization-challenge" title="Permalink to this headline">#</a></h3>
<p>The Ricker model is a classic discrete population model which was introduced in 1954 by Ricker to model recruitment of stock in fisheries. It gives the expected number (or density) <span class="math notranslate nohighlight">\(N_{t+1}\)</span> of individuals in generation <span class="math notranslate nohighlight">\(t + 1\)</span> as a function of the number of individuals in the previous generation <span class="math notranslate nohighlight">\(t\)</span>:</p>
<div class="math notranslate nohighlight">
\[ N_{t+1}= N_t e^{r\left(1-\frac{N_t}{k}\right)} \]</div>
<p>Here <span class="math notranslate nohighlight">\(r\)</span> is intrinsic growth rate and <span class="math notranslate nohighlight">\(k\)</span> as the carrying capacity of the environment. Try this script (call it <code class="docutils literal notranslate"><span class="pre">Ricker.R</span></code> and save it to <code class="docutils literal notranslate"><span class="pre">code</span></code>) that runs it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">Ricker</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">N0</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="m">10</span><span class="p">,</span> <span class="n">generations</span><span class="o">=</span><span class="m">50</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1"># Runs a simulation of the Ricker model</span>
  <span class="c1"># Returns a vector of length generations</span>
  
  <span class="n">N</span> <span class="o">&lt;-</span> <span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="n">generations</span><span class="p">)</span>    <span class="c1"># Creates a vector of NA</span>
  
  <span class="n">N</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">N0</span>
  <span class="nf">for </span><span class="p">(</span><span class="n">t</span> <span class="n">in</span> <span class="m">2</span><span class="o">:</span><span class="n">generations</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="m">-1</span><span class="p">]</span> <span class="o">*</span> <span class="nf">exp</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="p">(</span><span class="m">1.0</span><span class="o">-</span><span class="p">(</span><span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="m">-1</span><span class="p">]</span><span class="o">/</span><span class="n">K</span><span class="p">)))</span>
  <span class="p">}</span>
  <span class="nf">return </span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">plot</span><span class="p">(</span><span class="nf">Ricker</span><span class="p">(</span><span class="n">generations</span><span class="o">=</span><span class="m">10</span><span class="p">),</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/07-R_315_0.png" src="../_images/07-R_315_0.png" />
</div>
</div>
<p>Now open and run the script <code class="docutils literal notranslate"><span class="pre">Vectorize2.R</span></code> (available on the TheMulQuaBio repository). This is the stochastic Ricker model (compare with the above script to see where the stochasticity (random error) enters). Now modify the script to complete the exercise given.
<em>Your goal is to come up with a solution better than mine!</em></p>
</section>
</section>
<section id="errors-and-debugging">
<h2>Errors and Debugging<a class="headerlink" href="#errors-and-debugging" title="Permalink to this headline">#</a></h2>
<p>As we learned in <a class="reference internal" href="05-Python_I.html#python-errors"><span class="std std-ref">Python Chapter I</span></a>, dealing with errors is a fundamental programming task that never really goes away!</p>
<section id="unit-testing">
<h3>Unit testing<a class="headerlink" href="#unit-testing" title="Permalink to this headline">#</a></h3>
<p>We will not cover unit testing here, which we <a class="reference internal" href="05-Python_I.html#python-errors"><span class="std std-ref">did in Python Chapter I</span></a>). Unit testing in R is equally recommended if you are going to develop complex code and packages.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A very convenient tool for R unit testing is <a class="reference external" href="https://testthat.r-lib.org"><code class="docutils literal notranslate"><span class="pre">testthat</span></code></a>.</p>
</div>
<p>In addition, you can use other “<a class="reference external" href="https://en.wikipedia.org/wiki/Defensive_programming">defensive programming</a>” methods in R to keep an eye on errors that might arise in special circumstances in an complex program. A good option for this is to convert warnings to errors using the <a class="reference external" href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/stopifnot.html"><code class="docutils literal notranslate"><span class="pre">stopifnot()</span></code></a>. This is a bit like <code class="docutils literal notranslate"><span class="pre">try</span></code> (which we will cover below, and we also covered in <a class="reference internal" href="05-Python_I.html#python-errors"><span class="std std-ref">Python Chapter I</span></a>).</p>
</section>
<section id="debugging">
<h3>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">#</a></h3>
<p>Once you have found an error, you need to debug it. Assuming you have an idea about where (or the general area) in your code the error is, a simple way to debug is to use the  <code class="docutils literal notranslate"><span class="pre">browser()</span></code> function.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">browser()</span></code> function allows you to insert a breakpoint in your script (where the running of the script is stopped) and then step through your code. Place it within your script at the point you want to examine local variables  (e.g. inside a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop).</p>
<p>Let’s look at an example usage of <code class="docutils literal notranslate"><span class="pre">browser()</span></code>.</p>
<p>★ Type the following in a script file called <code class="docutils literal notranslate"><span class="pre">browse.R</span></code> and save in <code class="docutils literal notranslate"><span class="pre">code</span></code>:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">Exponential</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">N0</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">generations</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1"># Runs a simulation of exponential growth</span>
  <span class="c1"># Returns a vector of length generations</span>
  
  <span class="n">N</span> <span class="o">&lt;-</span> <span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="n">generations</span><span class="p">)</span>    <span class="c1"># Creates a vector of NA</span>
  
  <span class="n">N</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">N0</span>
  <span class="nf">for </span><span class="p">(</span><span class="n">t</span> <span class="n">in</span> <span class="m">2</span><span class="o">:</span><span class="n">generations</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="m">-1</span><span class="p">]</span> <span class="o">*</span> <span class="nf">exp</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="nf">browser</span><span class="p">()</span>
  <span class="p">}</span>
  <span class="nf">return </span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">plot</span><span class="p">(</span><span class="nf">Exponential</span><span class="p">(),</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="s">&quot;Exponential growth&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The script will be run till the first iteration of the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop and the console will enter the browser mode, which looks like this:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">Browse</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Now, you can examine the variables present at that point. Also, at the browser console, you can enter expressions as normal, or use a few particularly useful debug commands (similar to the Python debugger):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code>: single-step</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code>: exit browser and continue</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code>: exit browser and abort, return to top-level.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We will not cover advanced debugging here as we did <a class="reference internal" href="05-Python_I.html#python-errors"><span class="std std-ref">in Python Chapter I</span></a>, but look up <code class="docutils literal notranslate"><span class="pre">traceback()</span></code> (to find where the errors(s) are when a program crashes), and <code class="docutils literal notranslate"><span class="pre">debug()</span></code> (to debug a whole function).</p>
</div>
</section>
<section id="catching-errors">
<h3>“Catching” errors<a class="headerlink" href="#catching-errors" title="Permalink to this headline">#</a></h3>
<p>Often, you don’t know if a simulation or a R function will work on a particular data or variable, or a value of a variable (can happen in many statistical functions).</p>
<p>Indeed, as most of you must have already experienced by now, there can be frustrating, puzzling bugs in programs that lead to mysterious errors. Often, the error and warning messages you get are un-understandable, especially in R!</p>
<p>Rather than having R throw you out of the code, you would rather catch the error and keep going. This can be done by using the <code class="docutils literal notranslate"><span class="pre">try</span></code> keyword.</p>
<p>Lets try <code class="docutils literal notranslate"><span class="pre">try</span></code>!</p>
<p>First, let’s write a function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">doit</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">temp_x</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
    <span class="nf">if</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="n">temp_x</span><span class="p">))</span> <span class="o">&gt;</span> <span class="m">30</span><span class="p">)</span> <span class="p">{</span><span class="c1">#only take mean if sample was sufficient</span>
         <span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Mean of this sample was:&quot;</span><span class="p">,</span> <span class="nf">as.character</span><span class="p">(</span><span class="nf">mean</span><span class="p">(</span><span class="n">temp_x</span><span class="p">))))</span>
        <span class="p">}</span> 
    <span class="n">else</span> <span class="p">{</span>
        <span class="nf">stop</span><span class="p">(</span><span class="s">&quot;Couldn&#39;t calculate mean: too few unique values!&quot;</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>This function runs a simulation that involves sampling from a synthetic population with replacement and takes its mean, but <em>only</em> if at least 30 unique samples are obtained. Note that we have used another keyword here: <code class="docutils literal notranslate"><span class="pre">stop()</span></code>. Pay close attention to <code class="docutils literal notranslate"><span class="pre">sample()</span></code>, and <code class="docutils literal notranslate"><span class="pre">stop()</span></code> in the above script (check out what they are by using R help or searching online).</p>
<p>Now, generate your population:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">1345</span><span class="p">)</span> <span class="c1"># again, to get the same result for illustration</span>

<span class="n">popn</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">50</span><span class="p">)</span>

<span class="nf">hist</span><span class="p">(</span><span class="n">popn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/07-R_322_0.png" src="../_images/07-R_322_0.png" />
</div>
</div>
<p>Now try running it using <code class="docutils literal notranslate"><span class="pre">lapply</span></code> as you did above, repeating the sampling exercise 15 times:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">lapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">15</span><span class="p">,</span> <span class="nf">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="nf">doit</span><span class="p">(</span><span class="n">popn</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Mean of this sample was: -0.11620822588674&quot;
[1] &quot;Mean of this sample was: -0.0468516755995931&quot;
[1] &quot;Mean of this sample was: -0.0890228211466614&quot;
[1] &quot;Mean of this sample was: -0.124229742255296&quot;
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="n">Error</span> <span class="ow">in</span> <span class="n">doit</span><span class="p">(</span><span class="n">popn</span><span class="p">):</span> <span class="n">Couldn</span><span class="s1">&#39;t calculate mean: too few unique values!</span>
<span class="ne">Traceback</span>:

<span class="mi">1</span><span class="o">.</span> <span class="n">lapply</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="n">doit</span><span class="p">(</span><span class="n">popn</span><span class="p">))</span>
<span class="mi">2</span><span class="o">.</span> <span class="n">FUN</span><span class="p">(</span><span class="n">X</span><span class="p">[[</span><span class="n">i</span><span class="p">]],</span> <span class="o">...</span><span class="p">)</span>
<span class="mi">3</span><span class="o">.</span> <span class="n">doit</span><span class="p">(</span><span class="n">popn</span><span class="p">)</span>   <span class="c1"># at line 1 of file &lt;text&gt;</span>
<span class="mi">4</span><span class="o">.</span> <span class="n">stop</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t calculate mean: too few unique values!&quot;</span><span class="p">)</span>   <span class="c1"># at line 7 of file &lt;text&gt;</span>
</pre></div>
</div>
</div>
</div>
<p>Your result will be different than this (you would get between 0 - 15 samples; we got 4 here). But in most cases, the script will fail because of the <code class="docutils literal notranslate"><span class="pre">stop</span></code> command (on line 7 of the above function) at some iteration, returning less than the requested 15 mean values, followed by an error stating that the mean could not be calculated because too few unique values were sampled.</p>
<p>Now try doing the same using <code class="docutils literal notranslate"><span class="pre">try</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">&lt;-</span> <span class="nf">lapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">15</span><span class="p">,</span> <span class="nf">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="nf">try</span><span class="p">(</span><span class="nf">doit</span><span class="p">(</span><span class="n">popn</span><span class="p">),</span> <span class="kc">FALSE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Mean of this sample was: -0.11620822588674&quot;
[1] &quot;Mean of this sample was: -0.0468516755995931&quot;
[1] &quot;Mean of this sample was: -0.0890228211466614&quot;
[1] &quot;Mean of this sample was: -0.124229742255296&quot;
Error in doit(popn) : Couldn&#39;t calculate mean: too few unique values!
[1] &quot;Mean of this sample was: 0.0314144452816157&quot;
[1] &quot;Mean of this sample was: -0.233476945796405&quot;
[1] &quot;Mean of this sample was: -0.196681538928001&quot;
[1] &quot;Mean of this sample was: 0.0146969612111605&quot;
[1] &quot;Mean of this sample was: -0.234913159471725&quot;
[1] &quot;Mean of this sample was: -0.0497464588165691&quot;
Error in doit(popn) : Couldn&#39;t calculate mean: too few unique values!
[1] &quot;Mean of this sample was: 0.14834078393269&quot;
[1] &quot;Mean of this sample was: -0.271626543849156&quot;
[1] &quot;Mean of this sample was: -0.0661949014450445&quot;
</pre></div>
</div>
</div>
</div>
<p>In this run, you again asked for the means of 15 samples, and again you (most likely) got less than that (see the above example output), but without any error! The <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> modifier for the <code class="docutils literal notranslate"><span class="pre">try</span></code> command suppresses any error messages, but <code class="docutils literal notranslate"><span class="pre">result</span></code> will still contain them so that you can inspect them later (see below). <em>Please don’t forget to  check the help on inbuilt R commands like <code class="docutils literal notranslate"><span class="pre">try</span></code>.</em></p>
<p>The errors are stored in the object <code class="docutils literal notranslate"><span class="pre">result</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">class</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'list'</div></div>
</div>
<p>This is a list that stores the result of each of the 15 runs, including the ones that ran into an error. Have a look at it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1]]
[1] &quot;Error in doit(popn) : Couldn&#39;t calculate mean: too few unique values!\n&quot;
attr(,&quot;class&quot;)
[1] &quot;try-error&quot;
attr(,&quot;condition&quot;)
&lt;simpleError in doit(popn): Couldn&#39;t calculate mean: too few unique values!&gt;

[[2]]
[1] &quot;Mean of this sample was: -0.0639710889231533&quot;

[[3]]
[1] &quot;Mean of this sample was: 0.0954898884134274&quot;

[[4]]
[1] &quot;Error in doit(popn) : Couldn&#39;t calculate mean: too few unique values!\n&quot;
attr(,&quot;class&quot;)
[1] &quot;try-error&quot;
attr(,&quot;condition&quot;)
&lt;simpleError in doit(popn): Couldn&#39;t calculate mean: too few unique values!&gt;

[[5]]
[1] &quot;Mean of this sample was: 0.179497884968553&quot;

[[6]]
[1] &quot;Mean of this sample was: -0.0269560049619619&quot;

[[7]]
[1] &quot;Mean of this sample was: -0.0596177312603713&quot;

[[8]]
[1] &quot;Error in doit(popn) : Couldn&#39;t calculate mean: too few unique values!\n&quot;
attr(,&quot;class&quot;)
[1] &quot;try-error&quot;
attr(,&quot;condition&quot;)
&lt;simpleError in doit(popn): Couldn&#39;t calculate mean: too few unique values!&gt;

[[9]]
[1] &quot;Mean of this sample was: -0.169305162448064&quot;

[[10]]
[1] &quot;Mean of this sample was: -0.0570172067888256&quot;

[[11]]
[1] &quot;Mean of this sample was: 0.130501940679632&quot;

[[12]]
[1] &quot;Mean of this sample was: -0.0476960671278198&quot;

[[13]]
[1] &quot;Error in doit(popn) : Couldn&#39;t calculate mean: too few unique values!\n&quot;
attr(,&quot;class&quot;)
[1] &quot;try-error&quot;
attr(,&quot;condition&quot;)
&lt;simpleError in doit(popn): Couldn&#39;t calculate mean: too few unique values!&gt;

[[14]]
[1] &quot;Mean of this sample was: -0.0103821907230653&quot;

[[15]]
[1] &quot;Error in doit(popn) : Couldn&#39;t calculate mean: too few unique values!\n&quot;
attr(,&quot;class&quot;)
[1] &quot;try-error&quot;
attr(,&quot;condition&quot;)
&lt;simpleError in doit(popn): Couldn&#39;t calculate mean: too few unique values!&gt;
</pre></div>
</div>
</div>
</div>
<p>That’s a lot output! But basically it tells you which runs ran into and error and why (no surprises here, of course!). You can also store the results “manually” by using a loop to do the same:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">&lt;-</span> <span class="nf">vector</span><span class="p">(</span><span class="s">&quot;list&quot;</span><span class="p">,</span> <span class="m">15</span><span class="p">)</span> <span class="c1">#Preallocate/Initialize</span>
<span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="m">15</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">result</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span> <span class="o">&lt;-</span> <span class="nf">try</span><span class="p">(</span><span class="nf">doit</span><span class="p">(</span><span class="n">popn</span><span class="p">),</span> <span class="kc">FALSE</span><span class="p">)</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Mean of this sample was: 0.0690929258795289&quot;
[1] &quot;Mean of this sample was: -0.117793922564727&quot;
Error in doit(popn) : Couldn&#39;t calculate mean: too few unique values!
[1] &quot;Mean of this sample was: 0.179353333942007&quot;
[1] &quot;Mean of this sample was: 0.00392019401996458&quot;
[1] &quot;Mean of this sample was: -0.0432275201290453&quot;
Error in doit(popn) : Couldn&#39;t calculate mean: too few unique values!
[1] &quot;Mean of this sample was: -0.0869881356850989&quot;
Error in doit(popn) : Couldn&#39;t calculate mean: too few unique values!
[1] &quot;Mean of this sample was: 0.0984080957232758&quot;
Error in doit(popn) : Couldn&#39;t calculate mean: too few unique values!
[1] &quot;Mean of this sample was: 0.0856480925151331&quot;
[1] &quot;Mean of this sample was: 0.0462039547120371&quot;
Error in doit(popn) : Couldn&#39;t calculate mean: too few unique values!
[1] &quot;Mean of this sample was: -0.0147578826249971&quot;
</pre></div>
</div>
</div>
</div>
<p>Now have a look at the new <code class="docutils literal notranslate"><span class="pre">result</span></code>; it will have similar content as the one you got from using <code class="docutils literal notranslate"><span class="pre">lapply</span></code>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Also check out <code class="docutils literal notranslate"><span class="pre">tryCatch()</span></code> as an alternative to <code class="docutils literal notranslate"><span class="pre">try()</span></code>.</p>
</div>
<p>★ Type the above blocks of code illustrating <code class="docutils literal notranslate"><span class="pre">try</span></code> into a script file called <code class="docutils literal notranslate"><span class="pre">try.R</span></code> and save in <code class="docutils literal notranslate"><span class="pre">code</span></code>. The script, when <code class="docutils literal notranslate"><span class="pre">source</span></code>d, should run without errors (that is, don’t run the sampling function without <code class="docutils literal notranslate"><span class="pre">try</span></code>!).</p>
</section>
</section>
<section id="packages">
<h2>Packages<a class="headerlink" href="#packages" title="Permalink to this headline">#</a></h2>
<p>The big strength of R is that users can easily build and share packages through <a class="reference external" href="https://cran.r-project.org">cran.r-project.org</a>.</p>
<p>There are R packages for practically all statistical and mathematical analysis you might conceive, so check them out before reinventing the wheel. Visit <a class="reference external" href="https://cran.r-project.org">cran.r-project.org</a> and go to packages to see a list and a brief description.</p>
<p>In Windows and Macs and Linux, you can install a package within R by using the <code class="docutils literal notranslate"><span class="pre">install.packages()</span></code>command.</p>
<p>For example:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;tidyverse&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>You can also install multiple packages by concatenating their names: <code class="docutils literal notranslate"><span class="pre">install.packages(c(&quot;pack1&quot;,&quot;pack2&quot;,&quot;pack3&quot;))</span></code>
(three packages in this hypothetical example)</p>
<p>In Ubuntu, you will have to launch a <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">R</span></code>session to get <code class="docutils literal notranslate"><span class="pre">install.packages()</span></code>to work properly. Otherwise, you be forced to install the package in a non-standard location on your drive that does not require <code class="docutils literal notranslate"><span class="pre">sudo</span></code> privileges (nor recommended).</p>
<p>You can also use the RStudio GUI to install packages using your mouse and menu.</p>
<p>In Ubuntu, you can also use the bash terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install r-cran-tidyverse
</pre></div>
</div>
<p>★ Go ahead and install <code class="docutils literal notranslate"><span class="pre">tidyverse</span></code> if you don’t have it yet. We will be using it <a class="reference internal" href="08-Data_R.html"><span class="doc std std-doc">soon</span></a>!</p>
<section id="building-your-own">
<h3>Building your own<a class="headerlink" href="#building-your-own" title="Permalink to this headline">#</a></h3>
<p>You can combine your code, data sets and documentation to make a <em>bona fide</em> R package. You may wish to do this for particularly large projects that you think will be useful for others. Read the <a class="reference external" href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html"><em>Writing R Extensions</em></a> manual and see <em>package.skeleton</em> to get started.</p>
<p>The R tool set <a class="reference external" href="https://github.com/DomBennett/EcoDataTools">EcoDataTools</a> and the package <a class="reference external" href="https://github.com/quicklizard99/cheddar">cheddar</a> were written by Silwood Grad Students!</p>
</section>
</section>
<section id="id2">
<h2>Practicals<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<section id="is-florida-getting-warmer">
<h3>Is Florida getting warmer?<a class="headerlink" href="#is-florida-getting-warmer" title="Permalink to this headline">#</a></h3>
<p><em>This Practical assumes you have at least a basic understanding of <a class="reference internal" href="14-regress.html#regress-correlations"><span class="std std-ref">correlation coefficients</span></a> and <a class="reference internal" href="13-t_F_tests.html"><span class="doc std std-doc">p-values</span></a>.</em></p>
<p>Your goal is to write an R script that will help answer the question: <em>Is Florida getting warmer</em>?  Call this script <code class="docutils literal notranslate"><span class="pre">Florida.R</span></code>.</p>
<p>To answer the question, you need to calculate the <a class="reference internal" href="14-regress.html#regress-correlations"><span class="std std-ref">correlation coefficients</span></a> between temperature and time. However, you can’t use the standard p-value calculated for a correlation coefficient, because measurements of climatic variables in successive time-points in a time series (successive seconds, minutes, hours, months, years, etc.) are <em>not independent</em>. Therefore you will use a permutation analysis instead, by generating a distribution of random correlation coefficients and compare your observed coefficient with this random distribution.</p>
<p>Some guidelines:</p>
<ul class="simple">
<li><p>Load and examine the annual temperature dataset from Key West in Florida, USA for the 20th century:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">rm</span><span class="p">(</span><span class="n">list</span><span class="o">=</span><span class="nf">ls</span><span class="p">())</span>

<span class="nf">load</span><span class="p">(</span><span class="s">&quot;../data/KeyWestAnnualMeanTemperature.RData&quot;</span><span class="p">)</span>

<span class="nf">ls</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'ats'</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">class</span><span class="p">(</span><span class="n">ats</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'data.frame'</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">head</span><span class="p">(</span><span class="n">ats</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 2</caption>
<thead>
	<tr><th></th><th scope=col>Year</th><th scope=col>Temp</th></tr>
	<tr><th></th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>1901</td><td>23.75000</td></tr>
	<tr><th scope=row>2</th><td>1902</td><td>24.66667</td></tr>
	<tr><th scope=row>3</th><td>1903</td><td>24.71667</td></tr>
	<tr><th scope=row>4</th><td>1904</td><td>24.51667</td></tr>
	<tr><th scope=row>5</th><td>1905</td><td>24.88333</td></tr>
	<tr><th scope=row>6</th><td>1906</td><td>24.63333</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">ats</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/07-R_341_0.png" src="../_images/07-R_341_0.png" />
</div>
</div>
<p>Then,</p>
<ul class="simple">
<li><p>Compute the appropriate correlation coefficient between years and Temperature and store it (look at the help file for <code class="docutils literal notranslate"><span class="pre">cor()</span></code></p></li>
<li><p>Repeat this calculation a <em>sufficient</em> number of times, each time randomly reshuffling the temperatures (i.e., randomly re-assigning temperatures to years), and recalculating the correlation coefficient (and storing it)</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">sample</span></code> function that we learned about above to do the shuffling. Read the help file for this function and experiment with it.</p>
</div>
<ul class="simple">
<li><p>Calculate what fraction of the random correlation coefficients were greater than the observed one (this is your approximate, asymptotic p-value).</p></li>
<li><p><em>Interpret and present the results</em>: Present your results and their interpretation in a pdf document written in <span class="math notranslate nohighlight">\(\LaTeX\)</span> (include the the document’s source code in the submission) (<em>Keep the writeup, including any figures, to one A4 page</em>).</p></li>
</ul>
</section>
<section id="groupwork-practical-autocorrelation-in-florida-weather">
<h3>Groupwork Practical: Autocorrelation in Florida weather<a class="headerlink" href="#groupwork-practical-autocorrelation-in-florida-weather" title="Permalink to this headline">#</a></h3>
<p><em>This Practical assumes you have at least a basic understanding of <a class="reference internal" href="14-regress.html#regress-correlations"><span class="std std-ref">correlation coefficients</span></a> and <a class="reference internal" href="13-t_F_tests.html"><span class="doc std std-doc">p-values</span></a>.</em></p>
<p>Your goal is to write an R script (name it <code class="docutils literal notranslate"><span class="pre">TAutoCorr.R</span></code>) that will help answer the question: <em>Are temperatures of one year significantly correlated with the next year (successive years), across years in a given location</em>?</p>
<p>To answer this question, you need to calculate the correlation between (n-1) pairs of years, where <span class="math notranslate nohighlight">\(n\)</span> is the total number of years. However, here again, you can’t use the standard p-value calculated for a correlation coefficient, because measurements of climatic variables in successive time-points in a time series (successive seconds, minutes, hours, months, years, etc.) are <em>not independent</em>.</p>
<p>The general guidelines are:</p>
<ul class="simple">
<li><p>Compute the appropriate correlation coefficient between successive years and store it (look at the help file for <code class="docutils literal notranslate"><span class="pre">cor()</span></code></p></li>
<li><p>Repeat this calculation <em>a sufficient number of</em> times by – randomly permuting the time series, and then recalculating the correlation coefficient for each randomly permuted sequence of annual temperatures and storing it.</p></li>
<li><p>Then calculate what fraction of the correlation coefficients from the previous step were greater than that from step 1 (this is your approximate p-value).</p></li>
<li><p><em>Interpret and present the results</em> Present your results and their interpretation in a pdf document written in <span class="math notranslate nohighlight">\(\LaTeX\)</span> (submit the the document’s source code as well).</p></li>
</ul>
<!-- ### Practicals wrap-up
  
* Review and make sure you can run all the commands, code fragments, and named scripts we have built till now and get the expected outputs.

* Annotate/comment your code lines as much and as often as necessary using #.
    
* Keep all files organized in `code`, `data`and `results` directories

* (If you are required to as part of your course) `git add`, `commit` and `push` all your code and data from this chapter to your git repository by the given deadline. --></section>
</section>
<section id="readings-and-resources">
<h2>Readings and Resources<a class="headerlink" href="#readings-and-resources" title="Permalink to this headline">#</a></h2>
<p>Check the readings under the R directory in the TheMulQuaBio repository. Also, search online for “R tutorial”, and plenty will pop up. Choose ones that seem the most intuitive to you. * <em>Remember, all R packages come with pdf guides/documentation!</em></p>
<section id="r-as-a-programming-language">
<h3>R as a Programming language<a class="headerlink" href="#r-as-a-programming-language" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>There are excellent websites besides cran. In particular, check out
<a class="reference external" href="https://www.statmethods.net/">statmethods.net</a> and the <a class="reference external" href="https://en.wikibooks.org/wiki/R_Programming">R Wiki</a>.</p></li>
<li><p><a class="reference external" href="https://blog.sellorm.com/2017/12/18/learn-to-write-command-line-utilities-in-r/">https://blog.sellorm.com/2017/12/18/learn-to-write-command-line-utilities-in-r/</a></p></li>
<li><p><a class="reference external" href="https://www.r-bloggers.com/2019/11/r-scripts-as-command-line-tools/">https://www.r-bloggers.com/2019/11/r-scripts-as-command-line-tools/</a></p></li>
</ul>
</section>
<section id="mathematical-modelling-and-stats-in-r">
<h3>Mathematical modelling and Stats in R<a class="headerlink" href="#mathematical-modelling-and-stats-in-r" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>The Use R! series (all yellow books) by Springer are really good. In particular, consider: “A Beginner’s Guide to R”, “R by Example”, “Numerical Ecology With R”, “ggplot2” (coming up in the <a class="reference internal" href="08-Data_R.html"><span class="doc std std-doc">Visualization Chapter</span></a>, “A Primer of Ecology with R”, “Nonlinear Regression with R”, and “Analysis of Phylogenetics and Evolution with R”.</p></li>
<li><p>For more focus on dynamical models: Soetaert &amp; Herman. 2009 “A practical guide to ecological modelling: using R as a simulation platform”.</p></li>
</ul>
</section>
<section id="id3">
<h3>Debugging<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://testthat.r-lib.org/"><code class="docutils literal notranslate"><span class="pre">testthat</span></code></a>: Unit Testing for R by Hadley Wickham (also developer of the <code class="docutils literal notranslate"><span class="pre">tidyverse</span></code> package, including <code class="docutils literal notranslate"><span class="pre">ggplot</span></code>).</p></li>
<li><p><a class="reference external" href="https://adv-r.hadley.nz/debugging.html">Notes on debugging in R by Wickham</a></p></li>
<li><p>A good <a class="reference external" href="https://data-flair.training/blogs/debugging-in-r-programming">overview of debugging methods in R with examples</a></p></li>
<li><p><a class="reference external" href="http://www.biostat.jhsph.edu/~rpeng/docs/R-debug-tools.pdf">An introduction to the Interactive Debugging Tools in R</a> by Roger D Peng.</p></li>
<li><p>If you are using RStudio, <a class="reference external" href="https://support.rstudio.com/hc/en-us/articles/205612627-Debugging-with-RStudio">see this</a>.</p></li>
</ul>
</section>
<section id="sweave-and-knitr-and-beyond">
<h3>Sweave and knitr, and beyond<a class="headerlink" href="#sweave-and-knitr-and-beyond" title="Permalink to this headline">#</a></h3>
<p>There are tools built around R that allow you to write your Dissertation Report or some other document such that it can be updated automatically if embedded data analyses or R simulations / calculations change. Instead of inserting a prefabricated graph or table into the report, the master document contains the R code necessary to obtain it. When run through R, all data analysis output (tables, graphs, etc.) is created on the fly and inserted into a final document like a pdf or html. The report will then be automatically updated if data or analysis change, which allows for truly reproducible research. To learn more about these tools, check out:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://support.rstudio.com/hc/en-us/articles/200552056-Using-Sweave-and-knitr">Sweave and knitr</a> and <a class="reference external" href="http://yihui.name/knitr/">this</a></p></li>
<li><p><a class="reference external" href="https://quarto.org/">Quarto</a></p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="05-Python_I.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Biological Computing in Python I</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="06-Python_II.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Biological Computing in Python II</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Samraat Pawar<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>